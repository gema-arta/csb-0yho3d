{"version":3,"file":"bundle.js","sources":["../node_modules/svelte/internal/index.mjs","../node_modules/xstate/es/_virtual/_tslib.js","../node_modules/xstate/es/constants.js","../node_modules/xstate/es/environment.js","../node_modules/xstate/es/utils.js","../node_modules/xstate/es/types.js","../node_modules/xstate/es/actionTypes.js","../node_modules/xstate/es/actions.js","../node_modules/xstate/es/stateUtils.js","../node_modules/xstate/es/State.js","../node_modules/xstate/es/serviceScope.js","../node_modules/xstate/es/Actor.js","../node_modules/xstate/es/invokeUtils.js","../node_modules/xstate/es/StateNode.js","../node_modules/xstate/es/scheduler.js","../node_modules/xstate/es/registry.js","../node_modules/xstate/es/devTools.js","../node_modules/xstate/es/interpreter.js","../node_modules/svelte/store/index.mjs","../useMachine.js","../App.svelte","../node_modules/xstate/es/Machine.js","../index.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    const z_index = (parseInt(computed_style.zIndex) || 0) - 1;\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        `overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${z_index};`);\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            info.blocks[i] = null;\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.29.4' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n}\n\nexport { __assign, __read, __rest, __spread, __values };","var STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\nexport { DEFAULT_GUARD_TYPE, EMPTY_ACTIVITY_MAP, STATE_DELIMITER, TARGETLESS_KEY };","var IS_PRODUCTION = process.env.NODE_ENV === 'production';\nexport { IS_PRODUCTION };","import { __spread, __values, __read, __assign } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, TARGETLESS_KEY, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\n\nfunction keys(value) {\n  return Object.keys(value);\n}\n\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\n\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\n\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\n\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\n\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\n\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\n\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\n\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\n\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\n\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, __spread(array));\n}\n\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\n\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\n\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = __values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\n\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\n\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = __read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\n\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\n\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\n\nfunction updateContext(context, _event, assignActions, state) {\n  if (!IS_PRODUCTION) {\n    warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\n\nvar warn = function () {};\n\nif (!IS_PRODUCTION) {\n  warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\n\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\n\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\n\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return __assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\n\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return __assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\n\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return __assign(__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\n\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\n\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\n\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === DEFAULT_GUARD_TYPE) {\n    return guard.predicate(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\n\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    return {\n      type: src\n    };\n  }\n\n  return src;\n}\n\nexport { evaluateGuard, flatten, getEventType, isArray, isBuiltInEvent, isFunction, isMachine, isObservable, isPromiseLike, isStateLike, isString, keys, mapContext, mapFilterValues, mapValues, matchesState, nestedPath, normalizeTarget, partition, path, pathToStateValue, reportUnhandledExceptionOnInvocation, symbolObservable, toArray, toArrayStrict, toEventObject, toGuard, toInvokeSource, toSCXMLEvent, toStatePath, toStatePaths, toStateValue, toTransitionConfigArray, uniqueId, updateContext, updateHistoryStates, updateHistoryValue, warn };","var ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"Start\"] = \"xstate.start\";\n  ActionTypes[\"Stop\"] = \"xstate.stop\";\n  ActionTypes[\"Raise\"] = \"xstate.raise\";\n  ActionTypes[\"Send\"] = \"xstate.send\";\n  ActionTypes[\"Cancel\"] = \"xstate.cancel\";\n  ActionTypes[\"NullEvent\"] = \"\";\n  ActionTypes[\"Assign\"] = \"xstate.assign\";\n  ActionTypes[\"After\"] = \"xstate.after\";\n  ActionTypes[\"DoneState\"] = \"done.state\";\n  ActionTypes[\"DoneInvoke\"] = \"done.invoke\";\n  ActionTypes[\"Log\"] = \"xstate.log\";\n  ActionTypes[\"Init\"] = \"xstate.init\";\n  ActionTypes[\"Invoke\"] = \"xstate.invoke\";\n  ActionTypes[\"ErrorExecution\"] = \"error.execution\";\n  ActionTypes[\"ErrorCommunication\"] = \"error.communication\";\n  ActionTypes[\"ErrorPlatform\"] = \"error.platform\";\n  ActionTypes[\"ErrorCustom\"] = \"xstate.error\";\n  ActionTypes[\"Update\"] = \"xstate.update\";\n  ActionTypes[\"Pure\"] = \"xstate.pure\";\n  ActionTypes[\"Choose\"] = \"xstate.choose\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar SpecialTargets;\n\n(function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n})(SpecialTargets || (SpecialTargets = {}));\n\nexport { ActionTypes, SpecialTargets };","import { ActionTypes } from './types.js'; // xstate-specific action types\n\nvar start = ActionTypes.Start;\nvar stop = ActionTypes.Stop;\nvar raise = ActionTypes.Raise;\nvar send = ActionTypes.Send;\nvar cancel = ActionTypes.Cancel;\nvar nullEvent = ActionTypes.NullEvent;\nvar assign = ActionTypes.Assign;\nvar after = ActionTypes.After;\nvar doneState = ActionTypes.DoneState;\nvar log = ActionTypes.Log;\nvar init = ActionTypes.Init;\nvar invoke = ActionTypes.Invoke;\nvar errorExecution = ActionTypes.ErrorExecution;\nvar errorPlatform = ActionTypes.ErrorPlatform;\nvar error = ActionTypes.ErrorCustom;\nvar update = ActionTypes.Update;\nvar choose = ActionTypes.Choose;\nvar pure = ActionTypes.Pure;\nexport { after, assign, cancel, choose, doneState, error, errorExecution, errorPlatform, init, invoke, log, nullEvent, pure, raise, send, start, stop, update };","import { __assign, __read } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { toSCXMLEvent, isFunction, toEventObject, getEventType, isString, partition, updateContext, flatten, toArray, toGuard, evaluateGuard, warn, isArray } from './utils.js';\nimport { SpecialTargets, ActionTypes } from './types.js';\nimport { send as send$1, update, assign as assign$1, init, raise as raise$1, log as log$1, cancel as cancel$1, error as error$1, pure as pure$1, choose as choose$1 } from './actionTypes.js';\nvar initEvent = /*#__PURE__*/toSCXMLEvent({\n  type: init\n});\n\nfunction getActionFunction(actionType, actionFunctionMap) {\n  return actionFunctionMap ? actionFunctionMap[actionType] || undefined : undefined;\n}\n\nfunction toActionObject(action, actionFunctionMap) {\n  var actionObject;\n\n  if (isString(action) || typeof action === 'number') {\n    var exec = getActionFunction(action, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = {\n        type: action,\n        exec: exec\n      };\n    } else if (exec) {\n      actionObject = exec;\n    } else {\n      actionObject = {\n        type: action,\n        exec: undefined\n      };\n    }\n  } else if (isFunction(action)) {\n    actionObject = {\n      // Convert action to string if unnamed\n      type: action.name || action.toString(),\n      exec: action\n    };\n  } else {\n    var exec = getActionFunction(action.type, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = __assign(__assign({}, action), {\n        exec: exec\n      });\n    } else if (exec) {\n      var actionType = exec.type || action.type;\n      actionObject = __assign(__assign(__assign({}, exec), action), {\n        type: actionType\n      });\n    } else {\n      actionObject = action;\n    }\n  }\n\n  Object.defineProperty(actionObject, 'toString', {\n    value: function () {\n      return actionObject.type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return actionObject;\n}\n\nvar toActionObjects = function (action, actionFunctionMap) {\n  if (!action) {\n    return [];\n  }\n\n  var actions = isArray(action) ? action : [action];\n  return actions.map(function (subAction) {\n    return toActionObject(subAction, actionFunctionMap);\n  });\n};\n\nfunction toActivityDefinition(action) {\n  var actionObject = toActionObject(action);\n  return __assign(__assign({\n    id: isString(action) ? action : actionObject.id\n  }, actionObject), {\n    type: actionObject.type\n  });\n}\n/**\r\n * Raises an event. This places the event in the internal event queue, so that\r\n * the event is immediately consumed by the machine in the current step.\r\n *\r\n * @param eventType The event to raise.\r\n */\n\n\nfunction raise(event) {\n  if (!isString(event)) {\n    return send(event, {\n      to: SpecialTargets.Internal\n    });\n  }\n\n  return {\n    type: raise$1,\n    event: event\n  };\n}\n\nfunction resolveRaise(action) {\n  return {\n    type: raise$1,\n    _event: toSCXMLEvent(action.event)\n  };\n}\n/**\r\n * Sends an event. This returns an action that will be read by an interpreter to\r\n * send the event in the next step, after the current step is finished executing.\r\n *\r\n * @param event The event to send.\r\n * @param options Options to pass into the send event:\r\n *  - `id` - The unique send event identifier (used with `cancel()`).\r\n *  - `delay` - The number of milliseconds to delay the sending of the event.\r\n *  - `to` - The target of this event (by default, the machine the event was sent from).\r\n */\n\n\nfunction send(event, options) {\n  return {\n    to: options ? options.to : undefined,\n    type: send$1,\n    event: isFunction(event) ? event : toEventObject(event),\n    delay: options ? options.delay : undefined,\n    id: options && options.id !== undefined ? options.id : isFunction(event) ? event.name : getEventType(event)\n  };\n}\n\nfunction resolveSend(action, ctx, _event, delaysMap) {\n  var meta = {\n    _event: _event\n  }; // TODO: helper function for resolving Expr\n\n  var resolvedEvent = toSCXMLEvent(isFunction(action.event) ? action.event(ctx, _event.data, meta) : action.event);\n  var resolvedDelay;\n\n  if (isString(action.delay)) {\n    var configDelay = delaysMap && delaysMap[action.delay];\n    resolvedDelay = isFunction(configDelay) ? configDelay(ctx, _event.data, meta) : configDelay;\n  } else {\n    resolvedDelay = isFunction(action.delay) ? action.delay(ctx, _event.data, meta) : action.delay;\n  }\n\n  var resolvedTarget = isFunction(action.to) ? action.to(ctx, _event.data, meta) : action.to;\n  return __assign(__assign({}, action), {\n    to: resolvedTarget,\n    _event: resolvedEvent,\n    event: resolvedEvent.data,\n    delay: resolvedDelay\n  });\n}\n/**\r\n * Sends an event to this machine's parent.\r\n *\r\n * @param event The event to send to the parent machine.\r\n * @param options Options to pass into the send event.\r\n */\n\n\nfunction sendParent(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n/**\r\n * Sends an update event to this machine's parent.\r\n */\n\n\nfunction sendUpdate() {\n  return sendParent(update);\n}\n/**\r\n * Sends an event back to the sender of the original event.\r\n *\r\n * @param event The event to send back to the sender\r\n * @param options Options to pass into the send event\r\n */\n\n\nfunction respond(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: function (_, __, _a) {\n      var _event = _a._event;\n      return _event.origin; // TODO: handle when _event.origin is undefined\n    }\n  }));\n}\n\nvar defaultLogExpr = function (context, event) {\n  return {\n    context: context,\n    event: event\n  };\n};\n/**\r\n *\r\n * @param expr The expression function to evaluate which will be logged.\r\n *  Takes in 2 arguments:\r\n *  - `ctx` - the current state context\r\n *  - `event` - the event that caused this action to be executed.\r\n * @param label The label to give to the logged expression.\r\n */\n\n\nfunction log(expr, label) {\n  if (expr === void 0) {\n    expr = defaultLogExpr;\n  }\n\n  return {\n    type: log$1,\n    label: label,\n    expr: expr\n  };\n}\n\nvar resolveLog = function (action, ctx, _event) {\n  return __assign(__assign({}, action), {\n    value: isString(action.expr) ? action.expr : action.expr(ctx, _event.data, {\n      _event: _event\n    })\n  });\n};\n/**\r\n * Cancels an in-flight `send(...)` action. A canceled sent action will not\r\n * be executed, nor will its event be sent, unless it has already been sent\r\n * (e.g., if `cancel(...)` is called after the `send(...)` action's `delay`).\r\n *\r\n * @param sendId The `id` of the `send(...)` action to cancel.\r\n */\n\n\nvar cancel = function (sendId) {\n  return {\n    type: cancel$1,\n    sendId: sendId\n  };\n};\n/**\r\n * Starts an activity.\r\n *\r\n * @param activity The activity to start.\r\n */\n\n\nfunction start(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Start,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Stops an activity.\r\n *\r\n * @param activity The activity to stop.\r\n */\n\n\nfunction stop(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Stop,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Updates the current context of the machine.\r\n *\r\n * @param assignment An object that represents the partial context to update.\r\n */\n\n\nvar assign = function (assignment) {\n  return {\n    type: assign$1,\n    assignment: assignment\n  };\n};\n/**\r\n * Returns an event type that represents an implicit event that\r\n * is sent after the specified `delay`.\r\n *\r\n * @param delayRef The delay in milliseconds\r\n * @param id The state node ID where this event is handled\r\n */\n\n\nfunction after(delayRef, id) {\n  var idSuffix = id ? \"#\" + id : '';\n  return ActionTypes.After + \"(\" + delayRef + \")\" + idSuffix;\n}\n/**\r\n * Returns an event that represents that a final state node\r\n * has been reached in the parent state node.\r\n *\r\n * @param id The final state node's parent state node `id`\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction done(id, data) {\n  var type = ActionTypes.DoneState + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Returns an event that represents that an invoked service has terminated.\r\n *\r\n * An invoked service is terminated when it has reached a top-level final state node,\r\n * but not when it is canceled.\r\n *\r\n * @param id The final state node ID\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction doneInvoke(id, data) {\n  var type = ActionTypes.DoneInvoke + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction error(id, data) {\n  var type = ActionTypes.ErrorPlatform + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction pure(getActions) {\n  return {\n    type: ActionTypes.Pure,\n    get: getActions\n  };\n}\n/**\r\n * Forwards (sends) an event to a specified service.\r\n *\r\n * @param target The target service to forward the event to.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction forwardTo(target, options) {\n  return send(function (_, event) {\n    return event;\n  }, __assign(__assign({}, options), {\n    to: target\n  }));\n}\n/**\r\n * Escalates an error by sending it as an event to this machine's parent.\r\n *\r\n * @param errorData The error data to send, or the expression function that\r\n * takes in the `context`, `event`, and `meta`, and returns the error data to send.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction escalate(errorData, options) {\n  return sendParent(function (context, event, meta) {\n    return {\n      type: error$1,\n      data: isFunction(errorData) ? errorData(context, event, meta) : errorData\n    };\n  }, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n\nfunction choose(conds) {\n  return {\n    type: ActionTypes.Choose,\n    conds: conds\n  };\n}\n\nfunction resolveActions(machine, currentState, currentContext, _event, actions) {\n  var _a = __read(partition(actions, function (action) {\n    return action.type === assign$1;\n  }), 2),\n      assignActions = _a[0],\n      otherActions = _a[1];\n\n  var updatedContext = assignActions.length ? updateContext(currentContext, _event, assignActions, currentState) : currentContext;\n  var resolvedActions = flatten(otherActions.map(function (actionObject) {\n    var _a;\n\n    switch (actionObject.type) {\n      case raise$1:\n        return resolveRaise(actionObject);\n\n      case send$1:\n        var sendAction = resolveSend(actionObject, updatedContext, _event, machine.options.delays); // TODO: fix ActionTypes.Init\n\n        if (!IS_PRODUCTION) {\n          // warn after resolving as we can create better contextual message here\n          warn(!isString(actionObject.delay) || typeof sendAction.delay === 'number', // tslint:disable-next-line:max-line-length\n          \"No delay reference for delay expression '\" + actionObject.delay + \"' was found on machine '\" + machine.id + \"'\");\n        }\n\n        return sendAction;\n\n      case log$1:\n        return resolveLog(actionObject, updatedContext, _event);\n\n      case choose$1:\n        {\n          var chooseAction = actionObject;\n          var matchedActions = (_a = chooseAction.conds.find(function (condition) {\n            var guard = toGuard(condition.cond, machine.options.guards);\n            return !guard || evaluateGuard(machine, guard, updatedContext, _event, currentState);\n          })) === null || _a === void 0 ? void 0 : _a.actions;\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var resolved = resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions), machine.options.actions));\n          updatedContext = resolved[1];\n          return resolved[0];\n        }\n\n      case pure$1:\n        {\n          var matchedActions = actionObject.get(updatedContext, _event.data);\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var resolved = resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions), machine.options.actions));\n          updatedContext = resolved[1];\n          return resolved[0];\n        }\n\n      default:\n        return toActionObject(actionObject, machine.options.actions);\n    }\n  }));\n  return [resolvedActions, updatedContext];\n}\n\nexport { after, assign, cancel, choose, done, doneInvoke, error, escalate, forwardTo, getActionFunction, initEvent, log, pure, raise, resolveActions, resolveLog, resolveRaise, resolveSend, respond, send, sendParent, sendUpdate, start, stop, toActionObject, toActionObjects, toActivityDefinition };","import { __values, __spread } from './_virtual/_tslib.js';\nimport { keys, flatten } from './utils.js';\n\nvar isLeafNode = function (stateNode) {\n  return stateNode.type === 'atomic' || stateNode.type === 'final';\n};\n\nfunction getChildren(stateNode) {\n  return keys(stateNode.states).map(function (key) {\n    return stateNode.states[key];\n  });\n}\n\nfunction getAllStateNodes(stateNode) {\n  var stateNodes = [stateNode];\n\n  if (isLeafNode(stateNode)) {\n    return stateNodes;\n  }\n\n  return stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)));\n}\n\nfunction getConfiguration(prevStateNodes, stateNodes) {\n  var e_1, _a, e_2, _b, e_3, _c, e_4, _d;\n\n  var prevConfiguration = new Set(prevStateNodes);\n  var prevAdjList = getAdjList(prevConfiguration);\n  var configuration = new Set(stateNodes);\n\n  try {\n    // add all ancestors\n    for (var configuration_1 = __values(configuration), configuration_1_1 = configuration_1.next(); !configuration_1_1.done; configuration_1_1 = configuration_1.next()) {\n      var s = configuration_1_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configuration_1_1 && !configuration_1_1.done && (_a = configuration_1.return)) _a.call(configuration_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  var adjList = getAdjList(configuration);\n\n  try {\n    // add descendants\n    for (var configuration_2 = __values(configuration), configuration_2_1 = configuration_2.next(); !configuration_2_1.done; configuration_2_1 = configuration_2.next()) {\n      var s = configuration_2_1.value; // if previously active, add existing child nodes\n\n      if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n        if (prevAdjList.get(s)) {\n          prevAdjList.get(s).forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        } else {\n          s.initialStateNodes.forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        }\n      } else {\n        if (s.type === 'parallel') {\n          try {\n            for (var _e = (e_3 = void 0, __values(getChildren(s))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var child = _f.value;\n\n              if (child.type === 'history') {\n                continue;\n              }\n\n              if (!configuration.has(child)) {\n                configuration.add(child);\n\n                if (prevAdjList.get(child)) {\n                  prevAdjList.get(child).forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                } else {\n                  child.initialStateNodes.forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                }\n              }\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_c = _e.return)) _c.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    }\n  } catch (e_2_1) {\n    e_2 = {\n      error: e_2_1\n    };\n  } finally {\n    try {\n      if (configuration_2_1 && !configuration_2_1.done && (_b = configuration_2.return)) _b.call(configuration_2);\n    } finally {\n      if (e_2) throw e_2.error;\n    }\n  }\n\n  try {\n    // add all ancestors\n    for (var configuration_3 = __values(configuration), configuration_3_1 = configuration_3.next(); !configuration_3_1.done; configuration_3_1 = configuration_3.next()) {\n      var s = configuration_3_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (configuration_3_1 && !configuration_3_1.done && (_d = configuration_3.return)) _d.call(configuration_3);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return configuration;\n}\n\nfunction getValueFromAdj(baseNode, adjList) {\n  var childStateNodes = adjList.get(baseNode);\n\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n\n  if (baseNode.type === 'compound') {\n    var childStateNode = childStateNodes[0];\n\n    if (childStateNode) {\n      if (isLeafNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n\n  var stateValue = {};\n  childStateNodes.forEach(function (csn) {\n    stateValue[csn.key] = getValueFromAdj(csn, adjList);\n  });\n  return stateValue;\n}\n\nfunction getAdjList(configuration) {\n  var e_5, _a;\n\n  var adjList = new Map();\n\n  try {\n    for (var configuration_4 = __values(configuration), configuration_4_1 = configuration_4.next(); !configuration_4_1.done; configuration_4_1 = configuration_4.next()) {\n      var s = configuration_4_1.value;\n\n      if (!adjList.has(s)) {\n        adjList.set(s, []);\n      }\n\n      if (s.parent) {\n        if (!adjList.has(s.parent)) {\n          adjList.set(s.parent, []);\n        }\n\n        adjList.get(s.parent).push(s);\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (configuration_4_1 && !configuration_4_1.done && (_a = configuration_4.return)) _a.call(configuration_4);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return adjList;\n}\n\nfunction getValue(rootNode, configuration) {\n  var config = getConfiguration([rootNode], configuration);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\n\nfunction has(iterable, item) {\n  if (Array.isArray(iterable)) {\n    return iterable.some(function (member) {\n      return member === item;\n    });\n  }\n\n  if (iterable instanceof Set) {\n    return iterable.has(item);\n  }\n\n  return false; // TODO: fix\n}\n\nfunction nextEvents(configuration) {\n  return flatten(__spread(new Set(configuration.map(function (sn) {\n    return sn.ownEvents;\n  }))));\n}\n\nfunction isInFinalState(configuration, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(function (s) {\n      return s.type === 'final' && has(configuration, s);\n    });\n  }\n\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(function (sn) {\n      return isInFinalState(configuration, sn);\n    });\n  }\n\n  return false;\n}\n\nexport { getAdjList, getAllStateNodes, getChildren, getConfiguration, getValue, has, isInFinalState, isLeafNode, nextEvents };","import { __spread, __rest, __assign } from './_virtual/_tslib.js';\nimport { EMPTY_ACTIVITY_MAP } from './constants.js';\nimport { isString, matchesState, keys } from './utils.js';\nimport { nextEvents } from './stateUtils.js';\nimport { initEvent } from './actions.js';\n\nfunction stateValuesEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (isString(a) || isString(b)) {\n    return a === b;\n  }\n\n  var aKeys = keys(a);\n  var bKeys = keys(b);\n  return aKeys.length === bKeys.length && aKeys.every(function (key) {\n    return stateValuesEqual(a[key], b[key]);\n  });\n}\n\nfunction isState(state) {\n  if (isString(state)) {\n    return false;\n  }\n\n  return 'value' in state && 'history' in state;\n}\n\nfunction bindActionToState(action, state) {\n  var exec = action.exec;\n\n  var boundAction = __assign(__assign({}, action), {\n    exec: exec !== undefined ? function () {\n      return exec(state.context, state.event, {\n        action: action,\n        state: state,\n        _event: state._event\n      });\n    } : undefined\n  });\n\n  return boundAction;\n}\n\nvar State =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new State instance.\r\n   * @param value The state value\r\n   * @param context The extended state\r\n   * @param historyValue The tree representing historical values of the state nodes\r\n   * @param history The previous state\r\n   * @param actions An array of action objects to execute as side-effects\r\n   * @param activities A mapping of activities and whether they are started (`true`) or stopped (`false`).\r\n   * @param meta\r\n   * @param events Internal event queue. Should be empty with run-to-completion semantics.\r\n   * @param configuration\r\n   */\n  function State(config) {\n    var _this = this;\n\n    this.actions = [];\n    this.activities = EMPTY_ACTIVITY_MAP;\n    this.meta = {};\n    this.events = [];\n    this.value = config.value;\n    this.context = config.context;\n    this._event = config._event;\n    this._sessionid = config._sessionid;\n    this.event = this._event.data;\n    this.historyValue = config.historyValue;\n    this.history = config.history;\n    this.actions = config.actions || [];\n    this.activities = config.activities || EMPTY_ACTIVITY_MAP;\n    this.meta = config.meta || {};\n    this.events = config.events || [];\n    this.matches = this.matches.bind(this);\n    this.toStrings = this.toStrings.bind(this);\n    this.configuration = config.configuration;\n    this.transitions = config.transitions;\n    this.children = config.children;\n    this.done = !!config.done;\n    Object.defineProperty(this, 'nextEvents', {\n      get: function () {\n        return nextEvents(_this.configuration);\n      }\n    });\n  }\n  /**\r\n   * Creates a new State instance for the given `stateValue` and `context`.\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.from = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (stateValue.context !== context) {\n        return new State({\n          value: stateValue.value,\n          context: context,\n          _event: stateValue._event,\n          _sessionid: null,\n          historyValue: stateValue.historyValue,\n          history: stateValue.history,\n          actions: [],\n          activities: stateValue.activities,\n          meta: {},\n          events: [],\n          configuration: [],\n          transitions: [],\n          children: {}\n        });\n      }\n\n      return stateValue;\n    }\n\n    var _event = initEvent;\n    return new State({\n      value: stateValue,\n      context: context,\n      _event: _event,\n      _sessionid: null,\n      historyValue: undefined,\n      history: undefined,\n      actions: [],\n      activities: undefined,\n      meta: undefined,\n      events: [],\n      configuration: [],\n      transitions: [],\n      children: {}\n    });\n  };\n  /**\r\n   * Creates a new State instance for the given `config`.\r\n   * @param config The state config\r\n   */\n\n\n  State.create = function (config) {\n    return new State(config);\n  };\n  /**\r\n   * Creates a new `State` instance for the given `stateValue` and `context` with no actions (side-effects).\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.inert = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (!stateValue.actions.length) {\n        return stateValue;\n      }\n\n      var _event = initEvent;\n      return new State({\n        value: stateValue.value,\n        context: context,\n        _event: _event,\n        _sessionid: null,\n        historyValue: stateValue.historyValue,\n        history: stateValue.history,\n        activities: stateValue.activities,\n        configuration: stateValue.configuration,\n        transitions: [],\n        children: {}\n      });\n    }\n\n    return State.from(stateValue, context);\n  };\n  /**\r\n   * Returns an array of all the string leaf state node paths.\r\n   * @param stateValue\r\n   * @param delimiter The character(s) that separate each subpath in the string state node path.\r\n   */\n\n\n  State.prototype.toStrings = function (stateValue, delimiter) {\n    var _this = this;\n\n    if (stateValue === void 0) {\n      stateValue = this.value;\n    }\n\n    if (delimiter === void 0) {\n      delimiter = '.';\n    }\n\n    if (isString(stateValue)) {\n      return [stateValue];\n    }\n\n    var valueKeys = keys(stateValue);\n    return valueKeys.concat.apply(valueKeys, __spread(valueKeys.map(function (key) {\n      return _this.toStrings(stateValue[key], delimiter).map(function (s) {\n        return key + delimiter + s;\n      });\n    })));\n  };\n\n  State.prototype.toJSON = function () {\n    var _a = this,\n        configuration = _a.configuration,\n        transitions = _a.transitions,\n        jsonValues = __rest(_a, [\"configuration\", \"transitions\"]);\n\n    return jsonValues;\n  };\n  /**\r\n   * Whether the current state value is a subset of the given parent state value.\r\n   * @param parentStateValue\r\n   */\n\n\n  State.prototype.matches = function (parentStateValue) {\n    return matchesState(parentStateValue, this.value);\n  };\n\n  return State;\n}();\n\nexport { State, bindActionToState, isState, stateValuesEqual };","/**\r\n * Maintains a stack of the current service in scope.\r\n * This is used to provide the correct service to spawn().\r\n */\nvar serviceStack = [];\n\nvar provide = function (service, fn) {\n  serviceStack.push(service);\n  var result = fn(service);\n  serviceStack.pop();\n  return result;\n};\n\nvar consume = function (fn) {\n  return fn(serviceStack[serviceStack.length - 1]);\n};\n\nexport { consume, provide };","import { toInvokeSource, mapContext, isMachine } from './utils.js';\nimport { provide } from './serviceScope.js';\n\nfunction createNullActor(id) {\n  return {\n    id: id,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    toJSON: function () {\n      return {\n        id: id\n      };\n    }\n  };\n}\n/**\r\n * Creates a deferred actor that is able to be invoked given the provided\r\n * invocation information in its `.meta` value.\r\n *\r\n * @param invokeDefinition The meta information needed to invoke the actor.\r\n */\n\n\nfunction createInvocableActor(invokeDefinition, machine, context, _event) {\n  var _a;\n\n  var invokeSrc = toInvokeSource(invokeDefinition.src);\n  var serviceCreator = (_a = machine === null || machine === void 0 ? void 0 : machine.options.services) === null || _a === void 0 ? void 0 : _a[invokeSrc.type];\n  var resolvedData = invokeDefinition.data ? mapContext(invokeDefinition.data, context, _event) : undefined;\n  var tempActor = serviceCreator ? createDeferredActor(serviceCreator, invokeDefinition.id, resolvedData) : createNullActor(invokeDefinition.id);\n  tempActor.meta = invokeDefinition;\n  return tempActor;\n}\n\nfunction createDeferredActor(entity, id, data) {\n  var tempActor = createNullActor(id);\n  tempActor.deferred = true;\n\n  if (isMachine(entity)) {\n    // \"mute\" the existing service scope so potential spawned actors within the `.initialState` stay deferred here\n    tempActor.state = provide(undefined, function () {\n      return (data ? entity.withContext(data) : entity).initialState;\n    });\n  }\n\n  return tempActor;\n}\n\nfunction isActor(item) {\n  try {\n    return typeof item.send === 'function';\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { createDeferredActor, createInvocableActor, createNullActor, isActor };","import { __assign, __rest } from './_virtual/_tslib.js';\nimport { invoke } from './actionTypes.js';\nimport './actions.js';\n\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    var simpleSrc = {\n      type: src\n    };\n\n    simpleSrc.toString = function () {\n      return src;\n    }; // v4 compat - TODO: remove in v5\n\n\n    return simpleSrc;\n  }\n\n  return src;\n}\n\nfunction toInvokeDefinition(invokeConfig) {\n  return __assign(__assign({\n    type: invoke\n  }, invokeConfig), {\n    toJSON: function () {\n      var onDone = invokeConfig.onDone,\n          onError = invokeConfig.onError,\n          invokeDef = __rest(invokeConfig, [\"onDone\", \"onError\"]);\n\n      return __assign(__assign({}, invokeDef), {\n        type: invoke,\n        src: toInvokeSource(invokeConfig.src)\n      });\n    }\n  });\n}\n\nexport { toInvokeDefinition, toInvokeSource };","import { __assign, __values, __spread, __read, __rest } from './_virtual/_tslib.js';\nimport { STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { mapValues, isArray, flatten, keys, toArray, toStateValue, isString, getEventType, matchesState, path, evaluateGuard, mapContext, toSCXMLEvent, pathToStateValue, isBuiltInEvent, partition, updateHistoryValue, toStatePath, mapFilterValues, warn, toStatePaths, nestedPath, normalizeTarget, toGuard, toTransitionConfigArray, isMachine, isFunction } from './utils.js';\nimport { SpecialTargets } from './types.js';\nimport { getAllStateNodes, getConfiguration, has, getChildren, isInFinalState, getValue, isLeafNode } from './stateUtils.js';\nimport { start as start$1, stop as stop$1, invoke, update, nullEvent, raise as raise$1, send as send$1 } from './actionTypes.js';\nimport { done, start, raise, stop, toActionObjects, resolveActions, doneInvoke, error, toActionObject, toActivityDefinition, after, send, cancel, initEvent } from './actions.js';\nimport { State, stateValuesEqual } from './State.js';\nimport { createInvocableActor } from './Actor.js';\nimport { toInvokeDefinition } from './invokeUtils.js';\nvar NULL_EVENT = '';\nvar STATE_IDENTIFIER = '#';\nvar WILDCARD = '*';\nvar EMPTY_OBJECT = {};\n\nvar isStateId = function (str) {\n  return str[0] === STATE_IDENTIFIER;\n};\n\nvar createDefaultOptions = function () {\n  return {\n    actions: {},\n    guards: {},\n    services: {},\n    activities: {},\n    delays: {}\n  };\n};\n\nvar validateArrayifiedTransitions = function (stateNode, event, transitions) {\n  var hasNonLastUnguardedTarget = transitions.slice(0, -1).some(function (transition) {\n    return !('cond' in transition) && !('in' in transition) && (isString(transition.target) || isMachine(transition.target));\n  });\n  var eventText = event === NULL_EVENT ? 'the transient event' : \"event '\" + event + \"'\";\n  warn(!hasNonLastUnguardedTarget, \"One or more transitions for \" + eventText + \" on state '\" + stateNode.id + \"' are unreachable. \" + \"Make sure that the default transition is the last one defined.\");\n};\n\nvar StateNode =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function StateNode(\n  /**\r\n   * The raw config used to create the machine.\r\n   */\n  config, options,\n  /**\r\n   * The initial extended state\r\n   */\n  context) {\n    var _this = this;\n\n    this.config = config;\n    this.context = context;\n    /**\r\n     * The order this state node appears. Corresponds to the implicit SCXML document order.\r\n     */\n\n    this.order = -1;\n    this.__xstatenode = true;\n    this.__cache = {\n      events: undefined,\n      relativeValue: new Map(),\n      initialStateValue: undefined,\n      initialState: undefined,\n      on: undefined,\n      transitions: undefined,\n      candidates: {},\n      delayedTransitions: undefined\n    };\n    this.idMap = {};\n    this.options = Object.assign(createDefaultOptions(), options);\n    this.parent = this.options._parent;\n    this.key = this.config.key || this.options._key || this.config.id || '(machine)';\n    this.machine = this.parent ? this.parent.machine : this;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.delimiter = this.config.delimiter || (this.parent ? this.parent.delimiter : STATE_DELIMITER);\n    this.id = this.config.id || __spread([this.machine.key], this.path).join(this.delimiter);\n    this.version = this.parent ? this.parent.version : this.config.version;\n    this.type = this.config.type || (this.config.parallel ? 'parallel' : this.config.states && keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n\n    if (!IS_PRODUCTION) {\n      warn(!('parallel' in this.config), \"The \\\"parallel\\\" property is deprecated and will be removed in version 4.1. \" + (this.config.parallel ? \"Replace with `type: 'parallel'`\" : \"Use `type: '\" + this.type + \"'`\") + \" in the config for state node '\" + this.id + \"' instead.\");\n    }\n\n    this.initial = this.config.initial;\n    this.states = this.config.states ? mapValues(this.config.states, function (stateConfig, key) {\n      var _a;\n\n      var stateNode = new StateNode(stateConfig, {\n        _parent: _this,\n        _key: key\n      });\n      Object.assign(_this.idMap, __assign((_a = {}, _a[stateNode.id] = stateNode, _a), stateNode.idMap));\n      return stateNode;\n    }) : EMPTY_OBJECT; // Document order\n\n    var order = 0;\n\n    function dfs(stateNode) {\n      var e_1, _a;\n\n      stateNode.order = order++;\n\n      try {\n        for (var _b = __values(getChildren(stateNode)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          dfs(child);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    dfs(this); // History config\n\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this._transient = !!this.config.always || (!this.config.on ? false : Array.isArray(this.config.on) ? this.config.on.some(function (_a) {\n      var event = _a.event;\n      return event === NULL_EVENT;\n    }) : NULL_EVENT in this.config.on);\n    this.strict = !!this.config.strict; // TODO: deprecate (entry)\n\n    this.onEntry = toArray(this.config.entry || this.config.onEntry).map(function (action) {\n      return toActionObject(action);\n    }); // TODO: deprecate (exit)\n\n    this.onExit = toArray(this.config.exit || this.config.onExit).map(function (action) {\n      return toActionObject(action);\n    });\n    this.meta = this.config.meta;\n    this.doneData = this.type === 'final' ? this.config.data : undefined;\n    this.invoke = toArray(this.config.invoke).map(function (invokeConfig, i) {\n      var _a, _b;\n\n      if (isMachine(invokeConfig)) {\n        _this.machine.options.services = __assign((_a = {}, _a[invokeConfig.id] = invokeConfig, _a), _this.machine.options.services);\n        return toInvokeDefinition({\n          src: invokeConfig.id,\n          id: invokeConfig.id\n        });\n      } else if (isString(invokeConfig.src)) {\n        return toInvokeDefinition(__assign(__assign({}, invokeConfig), {\n          id: invokeConfig.id || invokeConfig.src,\n          src: invokeConfig.src\n        }));\n      } else if (isMachine(invokeConfig.src) || isFunction(invokeConfig.src)) {\n        var invokeSrc = _this.id + \":invocation[\" + i + \"]\"; // TODO: util function\n\n        _this.machine.options.services = __assign((_b = {}, _b[invokeSrc] = invokeConfig.src, _b), _this.machine.options.services);\n        return toInvokeDefinition(__assign(__assign({\n          id: invokeSrc\n        }, invokeConfig), {\n          src: invokeSrc\n        }));\n      } else {\n        var invokeSource = invokeConfig.src;\n        return toInvokeDefinition(__assign(__assign({\n          id: invokeSource.type\n        }, invokeConfig), {\n          src: invokeSource\n        }));\n      }\n    });\n    this.activities = toArray(this.config.activities).concat(this.invoke).map(function (activity) {\n      return toActivityDefinition(activity);\n    });\n    this.transition = this.transition.bind(this); // TODO: this is the real fix for initialization once\n    // state node getters are deprecated\n    // if (!this.parent) {\n    //   this._init();\n    // }\n  }\n\n  StateNode.prototype._init = function () {\n    if (this.__cache.transitions) {\n      return;\n    }\n\n    getAllStateNodes(this).forEach(function (stateNode) {\n      return stateNode.on;\n    });\n  };\n  /**\r\n   * Clones this state machine with custom options and context.\r\n   *\r\n   * @param options Options (actions, guards, activities, services) to recursively merge with the existing options.\r\n   * @param context Custom context (will override predefined context)\r\n   */\n\n\n  StateNode.prototype.withConfig = function (options, context) {\n    if (context === void 0) {\n      context = this.context;\n    }\n\n    var _a = this.options,\n        actions = _a.actions,\n        activities = _a.activities,\n        guards = _a.guards,\n        services = _a.services,\n        delays = _a.delays;\n    return new StateNode(this.config, {\n      actions: __assign(__assign({}, actions), options.actions),\n      activities: __assign(__assign({}, activities), options.activities),\n      guards: __assign(__assign({}, guards), options.guards),\n      services: __assign(__assign({}, services), options.services),\n      delays: __assign(__assign({}, delays), options.delays)\n    }, context);\n  };\n  /**\r\n   * Clones this state machine with custom context.\r\n   *\r\n   * @param context Custom context (will override predefined context, not recursive)\r\n   */\n\n\n  StateNode.prototype.withContext = function (context) {\n    return new StateNode(this.config, this.options, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"definition\", {\n    /**\r\n     * The well-structured state node definition.\r\n     */\n    get: function () {\n      return {\n        id: this.id,\n        key: this.key,\n        version: this.version,\n        context: this.context,\n        type: this.type,\n        initial: this.initial,\n        history: this.history,\n        states: mapValues(this.states, function (state) {\n          return state.definition;\n        }),\n        on: this.on,\n        transitions: this.transitions,\n        entry: this.onEntry,\n        exit: this.onExit,\n        activities: this.activities || [],\n        meta: this.meta,\n        order: this.order || -1,\n        data: this.doneData,\n        invoke: this.invoke\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.toJSON = function () {\n    return this.definition;\n  };\n\n  Object.defineProperty(StateNode.prototype, \"on\", {\n    /**\r\n     * The mapping of events to transitions.\r\n     */\n    get: function () {\n      if (this.__cache.on) {\n        return this.__cache.on;\n      }\n\n      var transitions = this.transitions;\n      return this.__cache.on = transitions.reduce(function (map, transition) {\n        map[transition.eventType] = map[transition.eventType] || [];\n        map[transition.eventType].push(transition);\n        return map;\n      }, {});\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"after\", {\n    get: function () {\n      return this.__cache.delayedTransitions || (this.__cache.delayedTransitions = this.getDelayedTransitions(), this.__cache.delayedTransitions);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"transitions\", {\n    /**\r\n     * All the transitions that can be taken from this state node.\r\n     */\n    get: function () {\n      return this.__cache.transitions || (this.__cache.transitions = this.formatTransitions(), this.__cache.transitions);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.getCandidates = function (eventName) {\n    if (this.__cache.candidates[eventName]) {\n      return this.__cache.candidates[eventName];\n    }\n\n    var transient = eventName === NULL_EVENT;\n    var candidates = this.transitions.filter(function (transition) {\n      var sameEventType = transition.eventType === eventName; // null events should only match against eventless transitions\n\n      return transient ? sameEventType : sameEventType || transition.eventType === WILDCARD;\n    });\n    this.__cache.candidates[eventName] = candidates;\n    return candidates;\n  };\n  /**\r\n   * All delayed transitions from the config.\r\n   */\n\n\n  StateNode.prototype.getDelayedTransitions = function () {\n    var _this = this;\n\n    var afterConfig = this.config.after;\n\n    if (!afterConfig) {\n      return [];\n    }\n\n    var mutateEntryExit = function (delay, i) {\n      var delayRef = isFunction(delay) ? _this.id + \":delay[\" + i + \"]\" : delay;\n      var eventType = after(delayRef, _this.id);\n\n      _this.onEntry.push(send(eventType, {\n        delay: delay\n      }));\n\n      _this.onExit.push(cancel(eventType));\n\n      return eventType;\n    };\n\n    var delayedTransitions = isArray(afterConfig) ? afterConfig.map(function (transition, i) {\n      var eventType = mutateEntryExit(transition.delay, i);\n      return __assign(__assign({}, transition), {\n        event: eventType\n      });\n    }) : flatten(keys(afterConfig).map(function (delay, i) {\n      var configTransition = afterConfig[delay];\n      var resolvedTransition = isString(configTransition) ? {\n        target: configTransition\n      } : configTransition;\n      var resolvedDelay = !isNaN(+delay) ? +delay : delay;\n      var eventType = mutateEntryExit(resolvedDelay, i);\n      return toArray(resolvedTransition).map(function (transition) {\n        return __assign(__assign({}, transition), {\n          event: eventType,\n          delay: resolvedDelay\n        });\n      });\n    }));\n    return delayedTransitions.map(function (delayedTransition) {\n      var delay = delayedTransition.delay;\n      return __assign(__assign({}, _this.formatTransition(delayedTransition)), {\n        delay: delay\n      });\n    });\n  };\n  /**\r\n   * Returns the state nodes represented by the current state value.\r\n   *\r\n   * @param state The state value or State instance\r\n   */\n\n\n  StateNode.prototype.getStateNodes = function (state) {\n    var _a;\n\n    var _this = this;\n\n    if (!state) {\n      return [];\n    }\n\n    var stateValue = state instanceof State ? state.value : toStateValue(state, this.delimiter);\n\n    if (isString(stateValue)) {\n      var initialStateValue = this.getStateNode(stateValue).initial;\n      return initialStateValue !== undefined ? this.getStateNodes((_a = {}, _a[stateValue] = initialStateValue, _a)) : [this.states[stateValue]];\n    }\n\n    var subStateKeys = keys(stateValue);\n    var subStateNodes = subStateKeys.map(function (subStateKey) {\n      return _this.getStateNode(subStateKey);\n    });\n    return subStateNodes.concat(subStateKeys.reduce(function (allSubStateNodes, subStateKey) {\n      var subStateNode = _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey]);\n\n      return allSubStateNodes.concat(subStateNode);\n    }, []));\n  };\n  /**\r\n   * Returns `true` if this state node explicitly handles the given event.\r\n   *\r\n   * @param event The event in question\r\n   */\n\n\n  StateNode.prototype.handles = function (event) {\n    var eventType = getEventType(event);\n    return this.events.includes(eventType);\n  };\n  /**\r\n   * Resolves the given `state` to a new `State` instance relative to this machine.\r\n   *\r\n   * This ensures that `.events` and `.nextEvents` represent the correct values.\r\n   *\r\n   * @param state The state to resolve\r\n   */\n\n\n  StateNode.prototype.resolveState = function (state) {\n    var configuration = Array.from(getConfiguration([], this.getStateNodes(state.value)));\n    return new State(__assign(__assign({}, state), {\n      value: this.resolve(state.value),\n      configuration: configuration\n    }));\n  };\n\n  StateNode.prototype.transitionLeafNode = function (stateValue, state, _event) {\n    var stateNode = this.getStateNode(stateValue);\n    var next = stateNode.next(state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionCompoundNode = function (stateValue, state, _event) {\n    var subStateKeys = keys(stateValue);\n    var stateNode = this.getStateNode(subStateKeys[0]);\n\n    var next = stateNode._transition(stateValue[subStateKeys[0]], state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionParallelNode = function (stateValue, state, _event) {\n    var e_2, _a;\n\n    var transitionMap = {};\n\n    try {\n      for (var _b = __values(keys(stateValue)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var subStateKey = _c.value;\n        var subStateValue = stateValue[subStateKey];\n\n        if (!subStateValue) {\n          continue;\n        }\n\n        var subStateNode = this.getStateNode(subStateKey);\n\n        var next = subStateNode._transition(subStateValue, state, _event);\n\n        if (next) {\n          transitionMap[subStateKey] = next;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var stateTransitions = keys(transitionMap).map(function (key) {\n      return transitionMap[key];\n    });\n    var enabledTransitions = flatten(stateTransitions.map(function (st) {\n      return st.transitions;\n    }));\n    var willTransition = stateTransitions.some(function (st) {\n      return st.transitions.length > 0;\n    });\n\n    if (!willTransition) {\n      return this.next(state, _event);\n    }\n\n    var entryNodes = flatten(stateTransitions.map(function (t) {\n      return t.entrySet;\n    }));\n    var configuration = flatten(keys(transitionMap).map(function (key) {\n      return transitionMap[key].configuration;\n    }));\n    return {\n      transitions: enabledTransitions,\n      entrySet: entryNodes,\n      exitSet: flatten(stateTransitions.map(function (t) {\n        return t.exitSet;\n      })),\n      configuration: configuration,\n      source: state,\n      actions: flatten(keys(transitionMap).map(function (key) {\n        return transitionMap[key].actions;\n      }))\n    };\n  };\n\n  StateNode.prototype._transition = function (stateValue, state, _event) {\n    // leaf node\n    if (isString(stateValue)) {\n      return this.transitionLeafNode(stateValue, state, _event);\n    } // hierarchical node\n\n\n    if (keys(stateValue).length === 1) {\n      return this.transitionCompoundNode(stateValue, state, _event);\n    } // orthogonal node\n\n\n    return this.transitionParallelNode(stateValue, state, _event);\n  };\n\n  StateNode.prototype.next = function (state, _event) {\n    var e_3, _a;\n\n    var _this = this;\n\n    var eventName = _event.name;\n    var actions = [];\n    var nextStateNodes = [];\n    var selectedTransition;\n\n    try {\n      for (var _b = __values(this.getCandidates(eventName)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var candidate = _c.value;\n        var cond = candidate.cond,\n            stateIn = candidate.in;\n        var resolvedContext = state.context;\n        var isInState = stateIn ? isString(stateIn) && isStateId(stateIn) ? // Check if in state by ID\n        state.matches(toStateValue(this.getStateNodeById(stateIn).path, this.delimiter)) : // Check if in state by relative grandparent\n        matchesState(toStateValue(stateIn, this.delimiter), path(this.path.slice(0, -2))(state.value)) : true;\n        var guardPassed = false;\n\n        try {\n          guardPassed = !cond || evaluateGuard(this.machine, cond, resolvedContext, _event, state);\n        } catch (err) {\n          throw new Error(\"Unable to evaluate guard '\" + (cond.name || cond.type) + \"' in transition for event '\" + eventName + \"' in state node '\" + this.id + \"':\\n\" + err.message);\n        }\n\n        if (guardPassed && isInState) {\n          if (candidate.target !== undefined) {\n            nextStateNodes = candidate.target;\n          }\n\n          actions.push.apply(actions, __spread(candidate.actions));\n          selectedTransition = candidate;\n          break;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    if (!selectedTransition) {\n      return undefined;\n    }\n\n    if (!nextStateNodes.length) {\n      return {\n        transitions: [selectedTransition],\n        entrySet: [],\n        exitSet: [],\n        configuration: state.value ? [this] : [],\n        source: state,\n        actions: actions\n      };\n    }\n\n    var allNextStateNodes = flatten(nextStateNodes.map(function (stateNode) {\n      return _this.getRelativeStateNodes(stateNode, state.historyValue);\n    }));\n    var isInternal = !!selectedTransition.internal;\n    var reentryNodes = isInternal ? [] : flatten(allNextStateNodes.map(function (n) {\n      return _this.nodesFromChild(n);\n    }));\n    return {\n      transitions: [selectedTransition],\n      entrySet: reentryNodes,\n      exitSet: isInternal ? [] : [this],\n      configuration: allNextStateNodes,\n      source: state,\n      actions: actions\n    };\n  };\n\n  StateNode.prototype.nodesFromChild = function (childStateNode) {\n    if (childStateNode.escapes(this)) {\n      return [];\n    }\n\n    var nodes = [];\n    var marker = childStateNode;\n\n    while (marker && marker !== this) {\n      nodes.push(marker);\n      marker = marker.parent;\n    }\n\n    nodes.push(this); // inclusive\n\n    return nodes;\n  };\n  /**\r\n   * Whether the given state node \"escapes\" this state node. If the `stateNode` is equal to or the parent of\r\n   * this state node, it does not escape.\r\n   */\n\n\n  StateNode.prototype.escapes = function (stateNode) {\n    if (this === stateNode) {\n      return false;\n    }\n\n    var parent = this.parent;\n\n    while (parent) {\n      if (parent === stateNode) {\n        return false;\n      }\n\n      parent = parent.parent;\n    }\n\n    return true;\n  };\n\n  StateNode.prototype.getActions = function (transition, currentContext, _event, prevState) {\n    var e_4, _a, e_5, _b;\n\n    var prevConfig = getConfiguration([], prevState ? this.getStateNodes(prevState.value) : [this]);\n    var resolvedConfig = transition.configuration.length ? getConfiguration(prevConfig, transition.configuration) : prevConfig;\n\n    try {\n      for (var resolvedConfig_1 = __values(resolvedConfig), resolvedConfig_1_1 = resolvedConfig_1.next(); !resolvedConfig_1_1.done; resolvedConfig_1_1 = resolvedConfig_1.next()) {\n        var sn = resolvedConfig_1_1.value;\n\n        if (!has(prevConfig, sn)) {\n          transition.entrySet.push(sn);\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (resolvedConfig_1_1 && !resolvedConfig_1_1.done && (_a = resolvedConfig_1.return)) _a.call(resolvedConfig_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var prevConfig_1 = __values(prevConfig), prevConfig_1_1 = prevConfig_1.next(); !prevConfig_1_1.done; prevConfig_1_1 = prevConfig_1.next()) {\n        var sn = prevConfig_1_1.value;\n\n        if (!has(resolvedConfig, sn) || has(transition.exitSet, sn.parent)) {\n          transition.exitSet.push(sn);\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (prevConfig_1_1 && !prevConfig_1_1.done && (_b = prevConfig_1.return)) _b.call(prevConfig_1);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    if (!transition.source) {\n      transition.exitSet = []; // Ensure that root StateNode (machine) is entered\n\n      transition.entrySet.push(this);\n    }\n\n    var doneEvents = flatten(transition.entrySet.map(function (sn) {\n      var events = [];\n\n      if (sn.type !== 'final') {\n        return events;\n      }\n\n      var parent = sn.parent;\n\n      if (!parent.parent) {\n        return events;\n      }\n\n      events.push(done(sn.id, sn.doneData), // TODO: deprecate - final states should not emit done events for their own state.\n      done(parent.id, sn.doneData ? mapContext(sn.doneData, currentContext, _event) : undefined));\n      var grandparent = parent.parent;\n\n      if (grandparent.type === 'parallel') {\n        if (getChildren(grandparent).every(function (parentNode) {\n          return isInFinalState(transition.configuration, parentNode);\n        })) {\n          events.push(done(grandparent.id));\n        }\n      }\n\n      return events;\n    }));\n    transition.exitSet.sort(function (a, b) {\n      return b.order - a.order;\n    });\n    transition.entrySet.sort(function (a, b) {\n      return a.order - b.order;\n    });\n    var entryStates = new Set(transition.entrySet);\n    var exitStates = new Set(transition.exitSet);\n\n    var _c = __read([flatten(Array.from(entryStates).map(function (stateNode) {\n      return __spread(stateNode.activities.map(function (activity) {\n        return start(activity);\n      }), stateNode.onEntry);\n    })).concat(doneEvents.map(raise)), flatten(Array.from(exitStates).map(function (stateNode) {\n      return __spread(stateNode.onExit, stateNode.activities.map(function (activity) {\n        return stop(activity);\n      }));\n    }))], 2),\n        entryActions = _c[0],\n        exitActions = _c[1];\n\n    var actions = toActionObjects(exitActions.concat(transition.actions).concat(entryActions), this.machine.options.actions);\n    return actions;\n  };\n  /**\r\n   * Determines the next state given the current `state` and sent `event`.\r\n   *\r\n   * @param state The current State instance or state value\r\n   * @param event The event that was sent at the current state\r\n   * @param context The current context (extended state) of the current state\r\n   */\n\n\n  StateNode.prototype.transition = function (state, event, context) {\n    if (state === void 0) {\n      state = this.initialState;\n    }\n\n    var _event = toSCXMLEvent(event);\n\n    var currentState;\n\n    if (state instanceof State) {\n      currentState = context === undefined ? state : this.resolveState(State.from(state, context));\n    } else {\n      var resolvedStateValue = isString(state) ? this.resolve(pathToStateValue(this.getResolvedPath(state))) : this.resolve(state);\n      var resolvedContext = context ? context : this.machine.context;\n      currentState = this.resolveState(State.from(resolvedStateValue, resolvedContext));\n    }\n\n    if (!IS_PRODUCTION && _event.name === WILDCARD) {\n      throw new Error(\"An event cannot have the wildcard type ('\" + WILDCARD + \"')\");\n    }\n\n    if (this.strict) {\n      if (!this.events.includes(_event.name) && !isBuiltInEvent(_event.name)) {\n        throw new Error(\"Machine '\" + this.id + \"' does not accept event '\" + _event.name + \"'\");\n      }\n    }\n\n    var stateTransition = this._transition(currentState.value, currentState, _event) || {\n      transitions: [],\n      configuration: [],\n      entrySet: [],\n      exitSet: [],\n      source: currentState,\n      actions: []\n    };\n    var prevConfig = getConfiguration([], this.getStateNodes(currentState.value));\n    var resolvedConfig = stateTransition.configuration.length ? getConfiguration(prevConfig, stateTransition.configuration) : prevConfig;\n    stateTransition.configuration = __spread(resolvedConfig);\n    return this.resolveTransition(stateTransition, currentState, _event);\n  };\n\n  StateNode.prototype.resolveRaisedTransition = function (state, _event, originalEvent) {\n    var _a;\n\n    var currentActions = state.actions;\n    state = this.transition(state, _event); // Save original event to state\n    // TODO: this should be the raised event! Delete in V5 (breaking)\n\n    state._event = originalEvent;\n    state.event = originalEvent.data;\n\n    (_a = state.actions).unshift.apply(_a, __spread(currentActions));\n\n    return state;\n  };\n\n  StateNode.prototype.resolveTransition = function (stateTransition, currentState, _event, context) {\n    var e_6, _a;\n\n    var _this = this;\n\n    if (_event === void 0) {\n      _event = initEvent;\n    }\n\n    if (context === void 0) {\n      context = this.machine.context;\n    }\n\n    var configuration = stateTransition.configuration; // Transition will \"apply\" if:\n    // - this is the initial state (there is no current state)\n    // - OR there are transitions\n\n    var willTransition = !currentState || stateTransition.transitions.length > 0;\n    var resolvedStateValue = willTransition ? getValue(this.machine, configuration) : undefined;\n    var historyValue = currentState ? currentState.historyValue ? currentState.historyValue : stateTransition.source ? this.machine.historyValue(currentState.value) : undefined : undefined;\n    var currentContext = currentState ? currentState.context : context;\n    var actions = this.getActions(stateTransition, currentContext, _event, currentState);\n    var activities = currentState ? __assign({}, currentState.activities) : {};\n\n    try {\n      for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {\n        var action = actions_1_1.value;\n\n        if (action.type === start$1) {\n          activities[action.activity.id || action.activity.type] = action;\n        } else if (action.type === stop$1) {\n          activities[action.activity.id || action.activity.type] = false;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    var _b = __read(resolveActions(this, currentState, currentContext, _event, actions), 2),\n        resolvedActions = _b[0],\n        updatedContext = _b[1];\n\n    var _c = __read(partition(resolvedActions, function (action) {\n      return action.type === raise$1 || action.type === send$1 && action.to === SpecialTargets.Internal;\n    }), 2),\n        raisedEvents = _c[0],\n        nonRaisedActions = _c[1];\n\n    var invokeActions = resolvedActions.filter(function (action) {\n      return action.type === start$1 && action.activity.type === invoke;\n    });\n    var children = invokeActions.reduce(function (acc, action) {\n      acc[action.activity.id] = createInvocableActor(action.activity, _this.machine, updatedContext, _event);\n      return acc;\n    }, currentState ? __assign({}, currentState.children) : {});\n    var resolvedConfiguration = resolvedStateValue ? stateTransition.configuration : currentState ? currentState.configuration : [];\n    var meta = resolvedConfiguration.reduce(function (acc, stateNode) {\n      if (stateNode.meta !== undefined) {\n        acc[stateNode.id] = stateNode.meta;\n      }\n\n      return acc;\n    }, {});\n    var isDone = isInFinalState(resolvedConfiguration, this);\n    var nextState = new State({\n      value: resolvedStateValue || currentState.value,\n      context: updatedContext,\n      _event: _event,\n      // Persist _sessionid between states\n      _sessionid: currentState ? currentState._sessionid : null,\n      historyValue: resolvedStateValue ? historyValue ? updateHistoryValue(historyValue, resolvedStateValue) : undefined : currentState ? currentState.historyValue : undefined,\n      history: !resolvedStateValue || stateTransition.source ? currentState : undefined,\n      actions: resolvedStateValue ? nonRaisedActions : [],\n      activities: resolvedStateValue ? activities : currentState ? currentState.activities : {},\n      meta: resolvedStateValue ? meta : currentState ? currentState.meta : undefined,\n      events: [],\n      configuration: resolvedConfiguration,\n      transitions: stateTransition.transitions,\n      children: children,\n      done: isDone\n    });\n    var didUpdateContext = currentContext !== updatedContext;\n    nextState.changed = _event.name === update || didUpdateContext; // Dispose of penultimate histories to prevent memory leaks\n\n    var history = nextState.history;\n\n    if (history) {\n      delete history.history;\n    }\n\n    if (!resolvedStateValue) {\n      return nextState;\n    }\n\n    var maybeNextState = nextState;\n\n    if (!isDone) {\n      var isTransient = this._transient || configuration.some(function (stateNode) {\n        return stateNode._transient;\n      });\n\n      if (isTransient) {\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, {\n          type: nullEvent\n        }, _event);\n      }\n\n      while (raisedEvents.length) {\n        var raisedEvent = raisedEvents.shift();\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, raisedEvent._event, _event);\n      }\n    } // Detect if state changed\n\n\n    var changed = maybeNextState.changed || (history ? !!maybeNextState.actions.length || didUpdateContext || typeof history.value !== typeof maybeNextState.value || !stateValuesEqual(maybeNextState.value, history.value) : undefined);\n    maybeNextState.changed = changed; // Preserve original history after raised events\n\n    maybeNextState.historyValue = nextState.historyValue;\n    maybeNextState.history = history;\n    return maybeNextState;\n  };\n  /**\r\n   * Returns the child state node from its relative `stateKey`, or throws.\r\n   */\n\n\n  StateNode.prototype.getStateNode = function (stateKey) {\n    if (isStateId(stateKey)) {\n      return this.machine.getStateNodeById(stateKey);\n    }\n\n    if (!this.states) {\n      throw new Error(\"Unable to retrieve child state '\" + stateKey + \"' from '\" + this.id + \"'; no child states exist.\");\n    }\n\n    var result = this.states[stateKey];\n\n    if (!result) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return result;\n  };\n  /**\r\n   * Returns the state node with the given `stateId`, or throws.\r\n   *\r\n   * @param stateId The state ID. The prefix \"#\" is removed.\r\n   */\n\n\n  StateNode.prototype.getStateNodeById = function (stateId) {\n    var resolvedStateId = isStateId(stateId) ? stateId.slice(STATE_IDENTIFIER.length) : stateId;\n\n    if (resolvedStateId === this.id) {\n      return this;\n    }\n\n    var stateNode = this.machine.idMap[resolvedStateId];\n\n    if (!stateNode) {\n      throw new Error(\"Child state node '#\" + resolvedStateId + \"' does not exist on machine '\" + this.id + \"'\");\n    }\n\n    return stateNode;\n  };\n  /**\r\n   * Returns the relative state node from the given `statePath`, or throws.\r\n   *\r\n   * @param statePath The string or string array relative path to the state node.\r\n   */\n\n\n  StateNode.prototype.getStateNodeByPath = function (statePath) {\n    if (typeof statePath === 'string' && isStateId(statePath)) {\n      try {\n        return this.getStateNodeById(statePath.slice(1));\n      } catch (e) {// try individual paths\n        // throw e;\n      }\n    }\n\n    var arrayStatePath = toStatePath(statePath, this.delimiter).slice();\n    var currentStateNode = this;\n\n    while (arrayStatePath.length) {\n      var key = arrayStatePath.shift();\n\n      if (!key.length) {\n        break;\n      }\n\n      currentStateNode = currentStateNode.getStateNode(key);\n    }\n\n    return currentStateNode;\n  };\n  /**\r\n   * Resolves a partial state value with its full representation in this machine.\r\n   *\r\n   * @param stateValue The partial state value to resolve.\r\n   */\n\n\n  StateNode.prototype.resolve = function (stateValue) {\n    var _a;\n\n    var _this = this;\n\n    if (!stateValue) {\n      return this.initialStateValue || EMPTY_OBJECT; // TODO: type-specific properties\n    }\n\n    switch (this.type) {\n      case 'parallel':\n        return mapValues(this.initialStateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(stateValue[subStateKey] || subStateValue) : EMPTY_OBJECT;\n        });\n\n      case 'compound':\n        if (isString(stateValue)) {\n          var subStateNode = this.getStateNode(stateValue);\n\n          if (subStateNode.type === 'parallel' || subStateNode.type === 'compound') {\n            return _a = {}, _a[stateValue] = subStateNode.initialStateValue, _a;\n          }\n\n          return stateValue;\n        }\n\n        if (!keys(stateValue).length) {\n          return this.initialStateValue || {};\n        }\n\n        return mapValues(stateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(subStateValue) : EMPTY_OBJECT;\n        });\n\n      default:\n        return stateValue || EMPTY_OBJECT;\n    }\n  };\n\n  StateNode.prototype.getResolvedPath = function (stateIdentifier) {\n    if (isStateId(stateIdentifier)) {\n      var stateNode = this.machine.idMap[stateIdentifier.slice(STATE_IDENTIFIER.length)];\n\n      if (!stateNode) {\n        throw new Error(\"Unable to find state node '\" + stateIdentifier + \"'\");\n      }\n\n      return stateNode.path;\n    }\n\n    return toStatePath(stateIdentifier, this.delimiter);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateValue\", {\n    get: function () {\n      var _a;\n\n      if (this.__cache.initialStateValue) {\n        return this.__cache.initialStateValue;\n      }\n\n      var initialStateValue;\n\n      if (this.type === 'parallel') {\n        initialStateValue = mapFilterValues(this.states, function (state) {\n          return state.initialStateValue || EMPTY_OBJECT;\n        }, function (stateNode) {\n          return !(stateNode.type === 'history');\n        });\n      } else if (this.initial !== undefined) {\n        if (!this.states[this.initial]) {\n          throw new Error(\"Initial state '\" + this.initial + \"' not found on '\" + this.key + \"'\");\n        }\n\n        initialStateValue = isLeafNode(this.states[this.initial]) ? this.initial : (_a = {}, _a[this.initial] = this.states[this.initial].initialStateValue, _a);\n      }\n\n      this.__cache.initialStateValue = initialStateValue;\n      return this.__cache.initialStateValue;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.getInitialState = function (stateValue, context) {\n    var configuration = this.getStateNodes(stateValue);\n    return this.resolveTransition({\n      configuration: configuration,\n      entrySet: configuration,\n      exitSet: [],\n      transitions: [],\n      source: undefined,\n      actions: []\n    }, undefined, undefined, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialState\", {\n    /**\r\n     * The initial State instance, which includes all actions to be executed from\r\n     * entering the initial state.\r\n     */\n    get: function () {\n      this._init(); // TODO: this should be in the constructor (see note in constructor)\n\n\n      var initialStateValue = this.initialStateValue;\n\n      if (!initialStateValue) {\n        throw new Error(\"Cannot retrieve initial state from simple state '\" + this.id + \"'.\");\n      }\n\n      return this.getInitialState(initialStateValue);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"target\", {\n    /**\r\n     * The target state value of the history state node, if it exists. This represents the\r\n     * default state value to transition to if no history value exists yet.\r\n     */\n    get: function () {\n      var target;\n\n      if (this.type === 'history') {\n        var historyConfig = this.config;\n\n        if (isString(historyConfig.target)) {\n          target = isStateId(historyConfig.target) ? pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length - 1)) : historyConfig.target;\n        } else {\n          target = historyConfig.target;\n        }\n      }\n\n      return target;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Returns the leaf nodes from a state path relative to this state node.\r\n   *\r\n   * @param relativeStateId The relative state path to retrieve the state nodes\r\n   * @param history The previous state to retrieve history\r\n   * @param resolve Whether state nodes should resolve to initial child state nodes\r\n   */\n\n  StateNode.prototype.getRelativeStateNodes = function (relativeStateId, historyValue, resolve) {\n    if (resolve === void 0) {\n      resolve = true;\n    }\n\n    return resolve ? relativeStateId.type === 'history' ? relativeStateId.resolveHistory(historyValue) : relativeStateId.initialStateNodes : [relativeStateId];\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateNodes\", {\n    get: function () {\n      var _this = this;\n\n      if (isLeafNode(this)) {\n        return [this];\n      } // Case when state node is compound but no initial state is defined\n\n\n      if (this.type === 'compound' && !this.initial) {\n        if (!IS_PRODUCTION) {\n          warn(false, \"Compound state node '\" + this.id + \"' has no initial state.\");\n        }\n\n        return [this];\n      }\n\n      var initialStateNodePaths = toStatePaths(this.initialStateValue);\n      return flatten(initialStateNodePaths.map(function (initialPath) {\n        return _this.getFromRelativePath(initialPath);\n      }));\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Retrieves state nodes from a relative path to this state node.\r\n   *\r\n   * @param relativePath The relative path from this state node\r\n   * @param historyValue\r\n   */\n\n  StateNode.prototype.getFromRelativePath = function (relativePath) {\n    if (!relativePath.length) {\n      return [this];\n    }\n\n    var _a = __read(relativePath),\n        stateKey = _a[0],\n        childStatePath = _a.slice(1);\n\n    if (!this.states) {\n      throw new Error(\"Cannot retrieve subPath '\" + stateKey + \"' from node with no states\");\n    }\n\n    var childStateNode = this.getStateNode(stateKey);\n\n    if (childStateNode.type === 'history') {\n      return childStateNode.resolveHistory();\n    }\n\n    if (!this.states[stateKey]) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return this.states[stateKey].getFromRelativePath(childStatePath);\n  };\n\n  StateNode.prototype.historyValue = function (relativeStateValue) {\n    if (!keys(this.states).length) {\n      return undefined;\n    }\n\n    return {\n      current: relativeStateValue || this.initialStateValue,\n      states: mapFilterValues(this.states, function (stateNode, key) {\n        if (!relativeStateValue) {\n          return stateNode.historyValue();\n        }\n\n        var subStateValue = isString(relativeStateValue) ? undefined : relativeStateValue[key];\n        return stateNode.historyValue(subStateValue || stateNode.initialStateValue);\n      }, function (stateNode) {\n        return !stateNode.history;\n      })\n    };\n  };\n  /**\r\n   * Resolves to the historical value(s) of the parent state node,\r\n   * represented by state nodes.\r\n   *\r\n   * @param historyValue\r\n   */\n\n\n  StateNode.prototype.resolveHistory = function (historyValue) {\n    var _this = this;\n\n    if (this.type !== 'history') {\n      return [this];\n    }\n\n    var parent = this.parent;\n\n    if (!historyValue) {\n      var historyTarget = this.target;\n      return historyTarget ? flatten(toStatePaths(historyTarget).map(function (relativeChildPath) {\n        return parent.getFromRelativePath(relativeChildPath);\n      })) : parent.initialStateNodes;\n    }\n\n    var subHistoryValue = nestedPath(parent.path, 'states')(historyValue).current;\n\n    if (isString(subHistoryValue)) {\n      return [parent.getStateNode(subHistoryValue)];\n    }\n\n    return flatten(toStatePaths(subHistoryValue).map(function (subStatePath) {\n      return _this.history === 'deep' ? parent.getFromRelativePath(subStatePath) : [parent.states[subStatePath[0]]];\n    }));\n  };\n\n  Object.defineProperty(StateNode.prototype, \"stateIds\", {\n    /**\r\n     * All the state node IDs of this state node and its descendant state nodes.\r\n     */\n    get: function () {\n      var _this = this;\n\n      var childStateIds = flatten(keys(this.states).map(function (stateKey) {\n        return _this.states[stateKey].stateIds;\n      }));\n      return [this.id].concat(childStateIds);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"events\", {\n    /**\r\n     * All the event types accepted by this state node and its descendants.\r\n     */\n    get: function () {\n      var e_7, _a, e_8, _b;\n\n      if (this.__cache.events) {\n        return this.__cache.events;\n      }\n\n      var states = this.states;\n      var events = new Set(this.ownEvents);\n\n      if (states) {\n        try {\n          for (var _c = __values(keys(states)), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var stateId = _d.value;\n            var state = states[stateId];\n\n            if (state.states) {\n              try {\n                for (var _e = (e_8 = void 0, __values(state.events)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                  var event_1 = _f.value;\n                  events.add(\"\" + event_1);\n                }\n              } catch (e_8_1) {\n                e_8 = {\n                  error: e_8_1\n                };\n              } finally {\n                try {\n                  if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                } finally {\n                  if (e_8) throw e_8.error;\n                }\n              }\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n\n      return this.__cache.events = Array.from(events);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"ownEvents\", {\n    /**\r\n     * All the events that have transitions directly from this state node.\r\n     *\r\n     * Excludes any inert events.\r\n     */\n    get: function () {\n      var events = new Set(this.transitions.filter(function (transition) {\n        return !(!transition.target && !transition.actions.length && transition.internal);\n      }).map(function (transition) {\n        return transition.eventType;\n      }));\n      return Array.from(events);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.resolveTarget = function (_target) {\n    var _this = this;\n\n    if (_target === undefined) {\n      // an undefined target signals that the state node should not transition from that state when receiving that event\n      return undefined;\n    }\n\n    return _target.map(function (target) {\n      if (!isString(target)) {\n        return target;\n      }\n\n      var isInternalTarget = target[0] === _this.delimiter; // If internal target is defined on machine,\n      // do not include machine key on target\n\n      if (isInternalTarget && !_this.parent) {\n        return _this.getStateNodeByPath(target.slice(1));\n      }\n\n      var resolvedTarget = isInternalTarget ? _this.key + target : target;\n\n      if (_this.parent) {\n        try {\n          var targetStateNode = _this.parent.getStateNodeByPath(resolvedTarget);\n\n          return targetStateNode;\n        } catch (err) {\n          throw new Error(\"Invalid transition definition for state node '\" + _this.id + \"':\\n\" + err.message);\n        }\n      } else {\n        return _this.getStateNodeByPath(resolvedTarget);\n      }\n    });\n  };\n\n  StateNode.prototype.formatTransition = function (transitionConfig) {\n    var _this = this;\n\n    var normalizedTarget = normalizeTarget(transitionConfig.target);\n    var internal = 'internal' in transitionConfig ? transitionConfig.internal : normalizedTarget ? normalizedTarget.some(function (_target) {\n      return isString(_target) && _target[0] === _this.delimiter;\n    }) : true;\n    var guards = this.machine.options.guards;\n    var target = this.resolveTarget(normalizedTarget);\n\n    var transition = __assign(__assign({}, transitionConfig), {\n      actions: toActionObjects(toArray(transitionConfig.actions)),\n      cond: toGuard(transitionConfig.cond, guards),\n      target: target,\n      source: this,\n      internal: internal,\n      eventType: transitionConfig.event,\n      toJSON: function () {\n        return __assign(__assign({}, transition), {\n          target: transition.target ? transition.target.map(function (t) {\n            return \"#\" + t.id;\n          }) : undefined,\n          source: \"#\" + _this.id\n        });\n      }\n    });\n\n    return transition;\n  };\n\n  StateNode.prototype.formatTransitions = function () {\n    var e_9, _a;\n\n    var _this = this;\n\n    var onConfig;\n\n    if (!this.config.on) {\n      onConfig = [];\n    } else if (Array.isArray(this.config.on)) {\n      onConfig = this.config.on;\n    } else {\n      var _b = this.config.on,\n          _c = WILDCARD,\n          _d = _b[_c],\n          wildcardConfigs = _d === void 0 ? [] : _d,\n          strictTransitionConfigs_1 = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n      onConfig = flatten(keys(strictTransitionConfigs_1).map(function (key) {\n        if (!IS_PRODUCTION && key === NULL_EVENT) {\n          warn(false, \"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. \" + (\"Please check the `on` configuration for \\\"#\" + _this.id + \"\\\".\"));\n        }\n\n        var transitionConfigArray = toTransitionConfigArray(key, strictTransitionConfigs_1[key]);\n\n        if (!IS_PRODUCTION) {\n          validateArrayifiedTransitions(_this, key, transitionConfigArray);\n        }\n\n        return transitionConfigArray;\n      }).concat(toTransitionConfigArray(WILDCARD, wildcardConfigs)));\n    }\n\n    var eventlessConfig = this.config.always ? toTransitionConfigArray('', this.config.always) : [];\n    var doneConfig = this.config.onDone ? toTransitionConfigArray(String(done(this.id)), this.config.onDone) : [];\n\n    if (!IS_PRODUCTION) {\n      warn(!(this.config.onDone && !this.parent), \"Root nodes cannot have an \\\".onDone\\\" transition. Please check the config of \\\"\" + this.id + \"\\\".\");\n    }\n\n    var invokeConfig = flatten(this.invoke.map(function (invokeDef) {\n      var settleTransitions = [];\n\n      if (invokeDef.onDone) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(doneInvoke(invokeDef.id)), invokeDef.onDone)));\n      }\n\n      if (invokeDef.onError) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(error(invokeDef.id)), invokeDef.onError)));\n      }\n\n      return settleTransitions;\n    }));\n    var delayedTransitions = this.after;\n    var formattedTransitions = flatten(__spread(doneConfig, invokeConfig, onConfig, eventlessConfig).map(function (transitionConfig) {\n      return toArray(transitionConfig).map(function (transition) {\n        return _this.formatTransition(transition);\n      });\n    }));\n\n    try {\n      for (var delayedTransitions_1 = __values(delayedTransitions), delayedTransitions_1_1 = delayedTransitions_1.next(); !delayedTransitions_1_1.done; delayedTransitions_1_1 = delayedTransitions_1.next()) {\n        var delayedTransition = delayedTransitions_1_1.value;\n        formattedTransitions.push(delayedTransition);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (delayedTransitions_1_1 && !delayedTransitions_1_1.done && (_a = delayedTransitions_1.return)) _a.call(delayedTransitions_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    return formattedTransitions;\n  };\n\n  return StateNode;\n}();\n\nexport { StateNode };","import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };","var children = /*#__PURE__*/new Map();\nvar sessionIdIndex = 0;\nvar registry = {\n  bookId: function () {\n    return \"x:\" + sessionIdIndex++;\n  },\n  register: function (id, actor) {\n    children.set(id, actor);\n    return id;\n  },\n  get: function (id) {\n    return children.get(id);\n  },\n  free: function (id) {\n    children.delete(id);\n  }\n};\nexport { registry };","import { IS_PRODUCTION } from './environment.js';\n\nfunction getDevTools() {\n  var w = window;\n\n  if (!!w.__xstate__) {\n    return w.__xstate__;\n  }\n\n  return undefined;\n}\n\nfunction registerService(service) {\n  if (IS_PRODUCTION || typeof window === 'undefined') {\n    return;\n  }\n\n  var devTools = getDevTools();\n\n  if (devTools) {\n    devTools.register(service);\n  }\n}\n\nexport { registerService };","import { __values, __assign, __spread } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { warn, mapContext, isFunction, keys, toSCXMLEvent, toInvokeSource, isPromiseLike, isObservable, isMachine, reportUnhandledExceptionOnInvocation, symbolObservable, isArray, toEventObject, isString, uniqueId } from './utils.js';\nimport { ActionTypes, SpecialTargets } from './types.js';\nimport { isInFinalState } from './stateUtils.js';\nimport { errorPlatform, log, stop, start, cancel, send, update, error as error$1 } from './actionTypes.js';\nimport { doneInvoke, initEvent, getActionFunction, error } from './actions.js';\nimport { isState, State, bindActionToState } from './State.js';\nimport { provide, consume } from './serviceScope.js';\nimport { isActor, createDeferredActor } from './Actor.js';\nimport { Scheduler } from './scheduler.js';\nimport { registry } from './registry.js';\nimport { registerService } from './devTools.js';\nvar DEFAULT_SPAWN_OPTIONS = {\n  sync: false,\n  autoForward: false\n};\nvar InterpreterStatus;\n\n(function (InterpreterStatus) {\n  InterpreterStatus[InterpreterStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  InterpreterStatus[InterpreterStatus[\"Running\"] = 1] = \"Running\";\n  InterpreterStatus[InterpreterStatus[\"Stopped\"] = 2] = \"Stopped\";\n})(InterpreterStatus || (InterpreterStatus = {}));\n\nvar Interpreter =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new Interpreter instance (i.e., service) for the given machine with the provided options, if any.\r\n   *\r\n   * @param machine The machine to be interpreted\r\n   * @param options Interpreter options\r\n   */\n  function Interpreter(machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = Interpreter.defaultOptions;\n    }\n\n    this.machine = machine;\n    this.scheduler = new Scheduler();\n    this.delayedEventsMap = {};\n    this.listeners = new Set();\n    this.contextListeners = new Set();\n    this.stopListeners = new Set();\n    this.doneListeners = new Set();\n    this.eventListeners = new Set();\n    this.sendListeners = new Set();\n    /**\r\n     * Whether the service is started.\r\n     */\n\n    this.initialized = false;\n    this._status = InterpreterStatus.NotStarted;\n    this.children = new Map();\n    this.forwardTo = new Set();\n    /**\r\n     * Alias for Interpreter.prototype.start\r\n     */\n\n    this.init = this.start;\n    /**\r\n     * Sends an event to the running interpreter to trigger a transition.\r\n     *\r\n     * An array of events (batched) can be sent as well, which will send all\r\n     * batched events to the running interpreter. The listeners will be\r\n     * notified only **once** when all events are processed.\r\n     *\r\n     * @param event The event(s) to send\r\n     */\n\n    this.send = function (event, payload) {\n      if (isArray(event)) {\n        _this.batch(event);\n\n        return _this.state;\n      }\n\n      var _event = toSCXMLEvent(toEventObject(event, payload));\n\n      if (_this._status === InterpreterStatus.Stopped) {\n        // do nothing\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to stopped service \\\"\" + _this.machine.id + \"\\\". This service has already reached its final state, and will not transition.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n\n        return _this.state;\n      }\n\n      if (_this._status === InterpreterStatus.NotStarted && _this.options.deferEvents) {\n        // tslint:disable-next-line:no-console\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\" and is deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n      } else if (_this._status !== InterpreterStatus.Running) {\n        throw new Error(\"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\\nEvent: \" + JSON.stringify(_event.data));\n      }\n\n      _this.scheduler.schedule(function () {\n        // Forward copy of event to child actors\n        _this.forward(_event);\n\n        var nextState = _this.nextState(_event);\n\n        _this.update(nextState, _event);\n      });\n\n      return _this._state; // TODO: deprecate (should return void)\n      // tslint:disable-next-line:semicolon\n    };\n\n    this.sendTo = function (event, to) {\n      var isParent = _this.parent && (to === SpecialTargets.Parent || _this.parent.id === to);\n      var target = isParent ? _this.parent : isActor(to) ? to : _this.children.get(to) || registry.get(to);\n\n      if (!target) {\n        if (!isParent) {\n          throw new Error(\"Unable to send event to child '\" + to + \"' from service '\" + _this.id + \"'.\");\n        } // tslint:disable-next-line:no-console\n\n\n        if (!IS_PRODUCTION) {\n          warn(false, \"Service '\" + _this.id + \"' has no parent: unable to send event \" + event.type);\n        }\n\n        return;\n      }\n\n      if ('machine' in target) {\n        // Send SCXML events to machines\n        target.send(__assign(__assign({}, event), {\n          name: event.name === error$1 ? \"\" + error(_this.id) : event.name,\n          origin: _this.sessionId\n        }));\n      } else {\n        // Send normal events to other targets\n        target.send(event.data);\n      }\n    };\n\n    var resolvedOptions = __assign(__assign({}, Interpreter.defaultOptions), options);\n\n    var clock = resolvedOptions.clock,\n        logger = resolvedOptions.logger,\n        parent = resolvedOptions.parent,\n        id = resolvedOptions.id;\n    var resolvedId = id !== undefined ? id : machine.id;\n    this.id = resolvedId;\n    this.logger = logger;\n    this.clock = clock;\n    this.parent = parent;\n    this.options = resolvedOptions;\n    this.scheduler = new Scheduler({\n      deferEvents: this.options.deferEvents\n    });\n    this.sessionId = registry.bookId();\n  }\n\n  Object.defineProperty(Interpreter.prototype, \"initialState\", {\n    get: function () {\n      var _this = this;\n\n      if (this._initialState) {\n        return this._initialState;\n      }\n\n      return provide(this, function () {\n        _this._initialState = _this.machine.initialState;\n        return _this._initialState;\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Interpreter.prototype, \"state\", {\n    get: function () {\n      if (!IS_PRODUCTION) {\n        warn(this._status !== InterpreterStatus.NotStarted, \"Attempted to read state from uninitialized service '\" + this.id + \"'. Make sure the service is started first.\");\n      }\n\n      return this._state;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Executes the actions of the given state, with that state's `context` and `event`.\r\n   *\r\n   * @param state The state whose actions will be executed\r\n   * @param actionsConfig The action implementations to use\r\n   */\n\n  Interpreter.prototype.execute = function (state, actionsConfig) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(state.actions), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var action = _c.value;\n        this.exec(action, state, actionsConfig);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.update = function (state, _event) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var _this = this; // Attach session ID to state\n\n\n    state._sessionid = this.sessionId; // Update state\n\n    this._state = state; // Execute actions\n\n    if (this.options.execute) {\n      this.execute(this.state);\n    } // Dev tools\n\n\n    if (this.devTools) {\n      this.devTools.send(_event.data, state);\n    } // Execute listeners\n\n\n    if (state.event) {\n      try {\n        for (var _e = __values(this.eventListeners), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var listener = _f.value;\n          listener(state.event);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    try {\n      for (var _g = __values(this.listeners), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var listener = _h.value;\n        listener(state, state.event);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    try {\n      for (var _j = __values(this.contextListeners), _k = _j.next(); !_k.done; _k = _j.next()) {\n        var contextListener = _k.value;\n        contextListener(this.state.context, this.state.history ? this.state.history.context : undefined);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_k && !_k.done && (_c = _j.return)) _c.call(_j);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    var isDone = isInFinalState(state.configuration || [], this.machine);\n\n    if (this.state.configuration && isDone) {\n      // get final child state node\n      var finalChildStateNode = state.configuration.find(function (sn) {\n        return sn.type === 'final' && sn.parent === _this.machine;\n      });\n      var doneData = finalChildStateNode && finalChildStateNode.doneData ? mapContext(finalChildStateNode.doneData, state.context, _event) : undefined;\n\n      try {\n        for (var _l = __values(this.doneListeners), _m = _l.next(); !_m.done; _m = _l.next()) {\n          var listener = _m.value;\n          listener(doneInvoke(this.id, doneData));\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (_m && !_m.done && (_d = _l.return)) _d.call(_l);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n\n      this.stop();\n    }\n  };\n  /*\r\n   * Adds a listener that is notified whenever a state transition happens. The listener is called with\r\n   * the next state and the event object that caused the state transition.\r\n   *\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onTransition = function (listener) {\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state, this.state.event);\n    }\n\n    return this;\n  };\n\n  Interpreter.prototype.subscribe = function (nextListenerOrObserver, _, // TODO: error listener\n  completeListener) {\n    var _this = this;\n\n    if (!nextListenerOrObserver) {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    }\n\n    var listener;\n    var resolvedCompleteListener = completeListener;\n\n    if (typeof nextListenerOrObserver === 'function') {\n      listener = nextListenerOrObserver;\n    } else {\n      listener = nextListenerOrObserver.next.bind(nextListenerOrObserver);\n      resolvedCompleteListener = nextListenerOrObserver.complete.bind(nextListenerOrObserver);\n    }\n\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state);\n    }\n\n    if (resolvedCompleteListener) {\n      this.onDone(resolvedCompleteListener);\n    }\n\n    return {\n      unsubscribe: function () {\n        listener && _this.listeners.delete(listener);\n        resolvedCompleteListener && _this.doneListeners.delete(resolvedCompleteListener);\n      }\n    };\n  };\n  /**\r\n   * Adds an event listener that is notified whenever an event is sent to the running interpreter.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onEvent = function (listener) {\n    this.eventListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds an event listener that is notified whenever a `send` event occurs.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onSend = function (listener) {\n    this.sendListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a context listener that is notified whenever the state context changes.\r\n   * @param listener The context listener\r\n   */\n\n\n  Interpreter.prototype.onChange = function (listener) {\n    this.contextListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a listener that is notified when the machine is stopped.\r\n   * @param listener The listener\r\n   */\n\n\n  Interpreter.prototype.onStop = function (listener) {\n    this.stopListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a state listener that is notified when the statechart has reached its final state.\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onDone = function (listener) {\n    this.doneListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Removes a listener.\r\n   * @param listener The listener to remove\r\n   */\n\n\n  Interpreter.prototype.off = function (listener) {\n    this.listeners.delete(listener);\n    this.eventListeners.delete(listener);\n    this.sendListeners.delete(listener);\n    this.stopListeners.delete(listener);\n    this.doneListeners.delete(listener);\n    this.contextListeners.delete(listener);\n    return this;\n  };\n  /**\r\n   * Starts the interpreter from the given state, or the initial state.\r\n   * @param initialState The state to start the statechart from\r\n   */\n\n\n  Interpreter.prototype.start = function (initialState) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n\n    registry.register(this.sessionId, this);\n    this.initialized = true;\n    this._status = InterpreterStatus.Running;\n    var resolvedState = initialState === undefined ? this.initialState : provide(this, function () {\n      return isState(initialState) ? _this.machine.resolveState(initialState) : _this.machine.resolveState(State.from(initialState, _this.machine.context));\n    });\n\n    if (this.options.devTools) {\n      this.attachDev();\n    }\n\n    this.scheduler.initialize(function () {\n      _this.update(resolvedState, initEvent);\n    });\n    return this;\n  };\n  /**\r\n   * Stops the interpreter and unsubscribe all listeners.\r\n   *\r\n   * This will also notify the `onStop` listeners.\r\n   */\n\n\n  Interpreter.prototype.stop = function () {\n    var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;\n\n    try {\n      for (var _f = __values(this.listeners), _g = _f.next(); !_g.done; _g = _f.next()) {\n        var listener = _g.value;\n        this.listeners.delete(listener);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    try {\n      for (var _h = __values(this.stopListeners), _j = _h.next(); !_j.done; _j = _h.next()) {\n        var listener = _j.value; // call listener, then remove\n\n        listener();\n        this.stopListeners.delete(listener);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this.contextListeners), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var listener = _l.value;\n        this.contextListeners.delete(listener);\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    try {\n      for (var _m = __values(this.doneListeners), _o = _m.next(); !_o.done; _o = _m.next()) {\n        var listener = _o.value;\n        this.doneListeners.delete(listener);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    } // Stop all children\n\n\n    this.children.forEach(function (child) {\n      if (isFunction(child.stop)) {\n        child.stop();\n      }\n    });\n\n    try {\n      // Cancel all delayed events\n      for (var _p = __values(keys(this.delayedEventsMap)), _q = _p.next(); !_q.done; _q = _p.next()) {\n        var key = _q.value;\n        this.clock.clearTimeout(this.delayedEventsMap[key]);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    this.scheduler.clear();\n    this.initialized = false;\n    this._status = InterpreterStatus.Stopped;\n    registry.free(this.sessionId);\n    return this;\n  };\n\n  Interpreter.prototype.batch = function (events) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.NotStarted && this.options.deferEvents) {\n      // tslint:disable-next-line:no-console\n      if (!IS_PRODUCTION) {\n        warn(false, events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\" and are deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(event));\n      }\n    } else if (this._status !== InterpreterStatus.Running) {\n      throw new Error( // tslint:disable-next-line:max-line-length\n      events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\");\n    }\n\n    this.scheduler.schedule(function () {\n      var e_11, _a;\n\n      var nextState = _this.state;\n      var batchChanged = false;\n      var batchedActions = [];\n\n      var _loop_1 = function (event_1) {\n        var _event = toSCXMLEvent(event_1);\n\n        _this.forward(_event);\n\n        nextState = provide(_this, function () {\n          return _this.machine.transition(nextState, _event);\n        });\n        batchedActions.push.apply(batchedActions, __spread(nextState.actions.map(function (a) {\n          return bindActionToState(a, nextState);\n        })));\n        batchChanged = batchChanged || !!nextState.changed;\n      };\n\n      try {\n        for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n          var event_1 = events_1_1.value;\n\n          _loop_1(event_1);\n        }\n      } catch (e_11_1) {\n        e_11 = {\n          error: e_11_1\n        };\n      } finally {\n        try {\n          if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n        } finally {\n          if (e_11) throw e_11.error;\n        }\n      }\n\n      nextState.changed = batchChanged;\n      nextState.actions = batchedActions;\n\n      _this.update(nextState, toSCXMLEvent(events[events.length - 1]));\n    });\n  };\n  /**\r\n   * Returns a send function bound to this interpreter instance.\r\n   *\r\n   * @param event The event to be sent by the sender.\r\n   */\n\n\n  Interpreter.prototype.sender = function (event) {\n    return this.send.bind(this, event);\n  };\n  /**\r\n   * Returns the next state given the interpreter's current state and the event.\r\n   *\r\n   * This is a pure method that does _not_ update the interpreter's state.\r\n   *\r\n   * @param event The event to determine the next state\r\n   */\n\n\n  Interpreter.prototype.nextState = function (event) {\n    var _this = this;\n\n    var _event = toSCXMLEvent(event);\n\n    if (_event.name.indexOf(errorPlatform) === 0 && !this.state.nextEvents.some(function (nextEvent) {\n      return nextEvent.indexOf(errorPlatform) === 0;\n    })) {\n      throw _event.data.data;\n    }\n\n    var nextState = provide(this, function () {\n      return _this.machine.transition(_this.state, _event);\n    });\n    return nextState;\n  };\n\n  Interpreter.prototype.forward = function (event) {\n    var e_12, _a;\n\n    try {\n      for (var _b = __values(this.forwardTo), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n        var child = this.children.get(id);\n\n        if (!child) {\n          throw new Error(\"Unable to forward event '\" + event + \"' from interpreter '\" + this.id + \"' to nonexistant child '\" + id + \"'.\");\n        }\n\n        child.send(event);\n      }\n    } catch (e_12_1) {\n      e_12 = {\n        error: e_12_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_12) throw e_12.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.defer = function (sendAction) {\n    var _this = this;\n\n    this.delayedEventsMap[sendAction.id] = this.clock.setTimeout(function () {\n      if (sendAction.to) {\n        _this.sendTo(sendAction._event, sendAction.to);\n      } else {\n        _this.send(sendAction._event);\n      }\n    }, sendAction.delay);\n  };\n\n  Interpreter.prototype.cancel = function (sendId) {\n    this.clock.clearTimeout(this.delayedEventsMap[sendId]);\n    delete this.delayedEventsMap[sendId];\n  };\n\n  Interpreter.prototype.exec = function (action, state, actionFunctionMap) {\n    if (actionFunctionMap === void 0) {\n      actionFunctionMap = this.machine.options.actions;\n    }\n\n    var context = state.context,\n        _event = state._event;\n    var actionOrExec = action.exec || getActionFunction(action.type, actionFunctionMap);\n    var exec = isFunction(actionOrExec) ? actionOrExec : actionOrExec ? actionOrExec.exec : action.exec;\n\n    if (exec) {\n      try {\n        return exec(context, _event.data, {\n          action: action,\n          state: this.state,\n          _event: _event\n        });\n      } catch (err) {\n        if (this.parent) {\n          this.parent.send({\n            type: 'xstate.error',\n            data: err\n          });\n        }\n\n        throw err;\n      }\n    }\n\n    switch (action.type) {\n      case send:\n        var sendAction = action;\n\n        if (typeof sendAction.delay === 'number') {\n          this.defer(sendAction);\n          return;\n        } else {\n          if (sendAction.to) {\n            this.sendTo(sendAction._event, sendAction.to);\n          } else {\n            this.send(sendAction._event);\n          }\n        }\n\n        break;\n\n      case cancel:\n        this.cancel(action.sendId);\n        break;\n\n      case start:\n        {\n          var activity = action.activity; // If the activity will be stopped right after it's started\n          // (such as in transient states)\n          // don't bother starting the activity.\n\n          if (!this.state.activities[activity.id || activity.type]) {\n            break;\n          } // Invoked services\n\n\n          if (activity.type === ActionTypes.Invoke) {\n            var invokeSource = toInvokeSource(activity.src);\n            var serviceCreator = this.machine.options.services ? this.machine.options.services[invokeSource.type] : undefined;\n            var id = activity.id,\n                data = activity.data;\n\n            if (!IS_PRODUCTION) {\n              warn(!('forward' in activity), // tslint:disable-next-line:max-line-length\n              \"`forward` property is deprecated (found in invocation of '\" + activity.src + \"' in in machine '\" + this.machine.id + \"'). \" + \"Please use `autoForward` instead.\");\n            }\n\n            var autoForward = 'autoForward' in activity ? activity.autoForward : !!activity.forward;\n\n            if (!serviceCreator) {\n              // tslint:disable-next-line:no-console\n              if (!IS_PRODUCTION) {\n                warn(false, \"No service found for invocation '\" + activity.src + \"' in machine '\" + this.machine.id + \"'.\");\n              }\n\n              return;\n            }\n\n            var resolvedData = data ? mapContext(data, context, _event) : undefined;\n            var source = isFunction(serviceCreator) ? serviceCreator(context, _event.data, {\n              data: resolvedData,\n              src: invokeSource\n            }) : serviceCreator;\n\n            if (isPromiseLike(source)) {\n              this.state.children[id] = this.spawnPromise(Promise.resolve(source), id);\n            } else if (isFunction(source)) {\n              this.state.children[id] = this.spawnCallback(source, id);\n            } else if (isObservable(source)) {\n              this.state.children[id] = this.spawnObservable(source, id);\n            } else if (isMachine(source)) {\n              // TODO: try/catch here\n              this.state.children[id] = this.spawnMachine(resolvedData ? source.withContext(resolvedData) : source, {\n                id: id,\n                autoForward: autoForward\n              });\n            }\n          } else {\n            this.spawnActivity(activity);\n          }\n\n          break;\n        }\n\n      case stop:\n        {\n          this.stopChild(action.activity.id);\n          break;\n        }\n\n      case log:\n        var label = action.label,\n            value = action.value;\n\n        if (label) {\n          this.logger(label, value);\n        } else {\n          this.logger(value);\n        }\n\n        break;\n\n      default:\n        if (!IS_PRODUCTION) {\n          warn(false, \"No implementation found for action type '\" + action.type + \"'\");\n        }\n\n        break;\n    }\n\n    return undefined;\n  };\n\n  Interpreter.prototype.removeChild = function (childId) {\n    this.children.delete(childId);\n    this.forwardTo.delete(childId);\n    delete this.state.children[childId];\n  };\n\n  Interpreter.prototype.stopChild = function (childId) {\n    var child = this.children.get(childId);\n\n    if (!child) {\n      return;\n    }\n\n    this.removeChild(childId);\n\n    if (isFunction(child.stop)) {\n      child.stop();\n    }\n  };\n\n  Interpreter.prototype.spawn = function (entity, name, options) {\n    if (isPromiseLike(entity)) {\n      return this.spawnPromise(Promise.resolve(entity), name);\n    } else if (isFunction(entity)) {\n      return this.spawnCallback(entity, name);\n    } else if (isActor(entity)) {\n      return this.spawnActor(entity);\n    } else if (isObservable(entity)) {\n      return this.spawnObservable(entity, name);\n    } else if (isMachine(entity)) {\n      return this.spawnMachine(entity, __assign(__assign({}, options), {\n        id: name\n      }));\n    } else {\n      throw new Error(\"Unable to spawn entity \\\"\" + name + \"\\\" of type \\\"\" + typeof entity + \"\\\".\");\n    }\n  };\n\n  Interpreter.prototype.spawnMachine = function (machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var childService = new Interpreter(machine, __assign(__assign({}, this.options), {\n      parent: this,\n      id: options.id || machine.id\n    }));\n\n    var resolvedOptions = __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), options);\n\n    if (resolvedOptions.sync) {\n      childService.onTransition(function (state) {\n        _this.send(update, {\n          state: state,\n          id: childService.id\n        });\n      });\n    }\n\n    var actor = childService;\n    this.children.set(childService.id, actor);\n\n    if (resolvedOptions.autoForward) {\n      this.forwardTo.add(childService.id);\n    }\n\n    childService.onDone(function (doneEvent) {\n      _this.removeChild(childService.id);\n\n      _this.send(toSCXMLEvent(doneEvent, {\n        origin: childService.id\n      }));\n    }).start();\n    return actor;\n  };\n\n  Interpreter.prototype.spawnPromise = function (promise, id) {\n    var _this = this;\n\n    var canceled = false;\n    promise.then(function (response) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        _this.send(toSCXMLEvent(doneInvoke(id, response), {\n          origin: id\n        }));\n      }\n    }, function (errorData) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        var errorEvent = error(id, errorData);\n\n        try {\n          // Send \"error.platform.id\" to this (parent).\n          _this.send(toSCXMLEvent(errorEvent, {\n            origin: id\n          }));\n        } catch (error) {\n          reportUnhandledExceptionOnInvocation(errorData, error, id);\n\n          if (_this.devTools) {\n            _this.devTools.send(errorEvent, _this.state);\n          }\n\n          if (_this.machine.strict) {\n            // it would be better to always stop the state machine if unhandled\n            // exception/promise rejection happens but because we don't want to\n            // break existing code so enforce it on strict mode only especially so\n            // because documentation says that onError is optional\n            _this.stop();\n          }\n        }\n      }\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        var unsubscribed = false;\n        promise.then(function (response) {\n          if (unsubscribed) {\n            return;\n          }\n\n          next && next(response);\n\n          if (unsubscribed) {\n            return;\n          }\n\n          complete && complete();\n        }, function (err) {\n          if (unsubscribed) {\n            return;\n          }\n\n          handleError(err);\n        });\n        return {\n          unsubscribe: function () {\n            return unsubscribed = true;\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnCallback = function (callback, id) {\n    var _this = this;\n\n    var canceled = false;\n    var receivers = new Set();\n    var listeners = new Set();\n\n    var receive = function (e) {\n      listeners.forEach(function (listener) {\n        return listener(e);\n      });\n\n      if (canceled) {\n        return;\n      }\n\n      _this.send(e);\n    };\n\n    var callbackStop;\n\n    try {\n      callbackStop = callback(receive, function (newListener) {\n        receivers.add(newListener);\n      });\n    } catch (err) {\n      this.send(error(id, err));\n    }\n\n    if (isPromiseLike(callbackStop)) {\n      // it turned out to be an async function, can't reliably check this before calling `callback`\n      // because transpiled async functions are not recognizable\n      return this.spawnPromise(callbackStop, id);\n    }\n\n    var actor = {\n      id: id,\n      send: function (event) {\n        return receivers.forEach(function (receiver) {\n          return receiver(event);\n        });\n      },\n      subscribe: function (next) {\n        listeners.add(next);\n        return {\n          unsubscribe: function () {\n            listeners.delete(next);\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n\n        if (isFunction(callbackStop)) {\n          callbackStop();\n        }\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnObservable = function (source, id) {\n    var _this = this;\n\n    var subscription = source.subscribe(function (value) {\n      _this.send(toSCXMLEvent(value, {\n        origin: id\n      }));\n    }, function (err) {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(error(id, err), {\n        origin: id\n      }));\n    }, function () {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(doneInvoke(id), {\n        origin: id\n      }));\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        return source.subscribe(next, handleError, complete);\n      },\n      stop: function () {\n        return subscription.unsubscribe();\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActor = function (actor) {\n    this.children.set(actor.id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActivity = function (activity) {\n    var implementation = this.machine.options && this.machine.options.activities ? this.machine.options.activities[activity.type] : undefined;\n\n    if (!implementation) {\n      if (!IS_PRODUCTION) {\n        warn(false, \"No implementation found for activity '\" + activity.type + \"'\");\n      } // tslint:disable-next-line:no-console\n\n\n      return;\n    } // Start implementation\n\n\n    var dispose = implementation(this.state.context, activity);\n    this.spawnEffect(activity.id, dispose);\n  };\n\n  Interpreter.prototype.spawnEffect = function (id, dispose) {\n    this.children.set(id, {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function () {\n        return {\n          unsubscribe: function () {\n            return void 0;\n          }\n        };\n      },\n      stop: dispose || undefined,\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    });\n  };\n\n  Interpreter.prototype.attachDev = function () {\n    if (this.options.devTools && typeof window !== 'undefined') {\n      if (window.__REDUX_DEVTOOLS_EXTENSION__) {\n        var devToolsOptions = typeof this.options.devTools === 'object' ? this.options.devTools : undefined;\n        this.devTools = window.__REDUX_DEVTOOLS_EXTENSION__.connect(__assign(__assign({\n          name: this.id,\n          autoPause: true,\n          stateSanitizer: function (state) {\n            return {\n              value: state.value,\n              context: state.context,\n              actions: state.actions\n            };\n          }\n        }, devToolsOptions), {\n          features: __assign({\n            jump: false,\n            skip: false\n          }, devToolsOptions ? devToolsOptions.features : undefined)\n        }), this.machine);\n        this.devTools.init(this.state);\n      } // add XState-specific dev tooling hook\n\n\n      registerService(this);\n    }\n  };\n\n  Interpreter.prototype.toJSON = function () {\n    return {\n      id: this.id\n    };\n  };\n\n  Interpreter.prototype[symbolObservable] = function () {\n    return this;\n  };\n  /**\r\n   * The default interpreter options:\r\n   *\r\n   * - `clock` uses the global `setTimeout` and `clearTimeout` functions\r\n   * - `logger` uses the global `console.log()` method\r\n   */\n\n\n  Interpreter.defaultOptions = /*#__PURE__*/function (global) {\n    return {\n      execute: true,\n      deferEvents: true,\n      clock: {\n        setTimeout: function (fn, ms) {\n          return global.setTimeout.call(null, fn, ms);\n        },\n        clearTimeout: function (id) {\n          return global.clearTimeout.call(null, id);\n        }\n      },\n      logger: global.console.log.bind(console),\n      devTools: false\n    };\n  }(typeof self !== 'undefined' ? self : global);\n\n  Interpreter.interpret = interpret;\n  return Interpreter;\n}();\n\nvar resolveSpawnOptions = function (nameOrOptions) {\n  if (isString(nameOrOptions)) {\n    return __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n      name: nameOrOptions\n    });\n  }\n\n  return __assign(__assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n    name: uniqueId()\n  }), nameOrOptions);\n};\n\nfunction spawn(entity, nameOrOptions) {\n  var resolvedOptions = resolveSpawnOptions(nameOrOptions);\n  return consume(function (service) {\n    if (!IS_PRODUCTION) {\n      var isLazyEntity = isMachine(entity) || isFunction(entity);\n      warn(!!service || isLazyEntity, \"Attempted to spawn an Actor (ID: \\\"\" + (isMachine(entity) ? entity.id : 'undefined') + \"\\\") outside of a service. This will have no effect.\");\n    }\n\n    if (service) {\n      return service.spawn(entity, resolvedOptions.name, resolvedOptions);\n    } else {\n      return createDeferredActor(entity, resolvedOptions.name);\n    }\n  });\n}\n/**\r\n * Creates a new Interpreter instance for the given machine with the provided options, if any.\r\n *\r\n * @param machine The machine to interpret\r\n * @param options Interpreter options\r\n */\n\n\nfunction interpret(machine, options) {\n  var interpreter = new Interpreter(machine, options);\n  return interpreter;\n}\n\nexport { Interpreter, interpret, spawn };","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal';\nexport { get_store_value as get } from '../internal';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","import { readable } from \"svelte/store\";\nimport { interpret } from \"xstate\";\n\nexport function useMachine(machine, options) {\n  const service = interpret(machine, options);\n\n  const store = readable(service.initialState, set => {\n    service.onTransition(state => {\n      set(state);\n    });\n\n    service.start();\n\n    return () => {\n      service.stop();\n    };\n  });\n\n  return {\n    state: store,\n    send: service.send\n  };\n}\n","<script>\n  import { createMachine, assign } from \"xstate\";\n  import { useMachine } from \"./useMachine\";\n  import Button from \"./Button.svelte\";\n\n  const toggleMachine = createMachine({\n    id: \"toggle\",\n    initial: \"inactive\",\n    context: {\n      count: 0\n    },\n    states: {\n      inactive: {\n        on: { TOGGLE: \"active\" }\n      },\n      active: {\n        entry: assign({ count: ctx => ctx.count + 1 }),\n        on: { TOGGLE: \"inactive\" }\n      }\n    }\n  });\n\n  const { state, send } = useMachine(toggleMachine);\n\n  $: active = $state.matches(\"active\");\n  $: count = $state.context.count;\n</script>\n\n<style>\n  main {\n    font-family: sans-serif;\n    text-align: center;\n  }\n</style>\n\n<main>\n  <h1>XState Svelte Template</h1>\n  <h2>Fork this template!</h2>\n  <button on:click={() => send(\"TOGGLE\")}>\n    Click me ({active ? \"✅\" : \"❌\"})\n  </button>{\" \"}\n  <code>\n    Toggled <strong>{count}</strong> times\n  </code>\n</main>","import { StateNode } from './StateNode.js';\n\nfunction Machine(config, options, initialContext) {\n  if (initialContext === void 0) {\n    initialContext = config.context;\n  }\n\n  var resolvedInitialContext = typeof initialContext === 'function' ? initialContext() : initialContext;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nfunction createMachine(config, options) {\n  var resolvedInitialContext = typeof config.context === 'function' ? config.context() : config.context;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nexport { Machine, createMachine };","import App from \"./App.svelte\";\n\nconst app = new App({\n  target: document.body\n});\n\nexport default app;\n"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","component_subscribe","component","store","callback","$$","on_destroy","push","callbacks","unsub","subscribe","unsubscribe","append","target","node","appendChild","detach","parentNode","removeChild","element","name","document","createElement","text","data","createTextNode","space","set_data","wholeText","current_component","set_current_component","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","flushing","seen_callbacks","Set","flush","i","length","update","pop","has","add","clear","fragment","before_update","dirty","p","ctx","after_update","outroing","make_dirty","then","fill","init","options","instance","create_fragment","not_equal","props","parent_component","prop_values","bound","on_mount","context","Map","skip_bound","ready","ret","rest","value","hydrate","nodes","Array","from","childNodes","l","c","intro","block","delete","local","anchor","m","new_on_destroy","map","filter","mount_component","SvelteComponent","[object Object]","detaching","d","destroy_component","this","$destroy","type","index","indexOf","splice","$$props","obj","$$set","keys","__assign","assign","t","s","n","arguments","prototype","hasOwnProperty","call","apply","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","__values","o","Symbol","iterator","next","done","__read","r","ar","error","__spread","concat","STATE_DELIMITER","EMPTY_ACTIVITY_MAP","DEFAULT_GUARD_TYPE","TARGETLESS_KEY","IS_PRODUCTION","process","env","NODE_ENV","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","Error","toStatePath","stateId","isArray","toString","split","stateValue","state","pathToStateValue","statePath","marker","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","_c","item","e_1_1","return","path","object","e_2","props_1","props_1_1","e_2_1","toStatePaths","flatten","subStateValue","subPath","array","toArrayStrict","toArray","undefined","mapContext","mapper","_event","e_5","isFunction","subMapper","e_5_1","isPromiseLike","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","states","subHist","current","warn","toGuard","condition","guardMap","isObservable","message","console","args","ActionTypes","SpecialTargets","symbolObservable","observable","isMachine","toEventObject","payload","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitionLike","evaluateGuard","machine","guard","guards","guardMeta","cond","condFn","id","toInvokeSource","src","start","Start","stop","Stop","raise","Raise","send","Send","cancel","Cancel","nullEvent","NullEvent","Assign","log","After","DoneState","Log","Init","invoke","Invoke","errorPlatform","ErrorExecution","ErrorPlatform","ErrorCustom","Update","choose","Choose","pure","Pure","initEvent","getActionFunction","actionType","actionFunctionMap","toActionObject","action","actionObject","exec","defineProperty","enumerable","configurable","toActionObjects","subAction","toActivityDefinition","raise$1","to","Internal","send$1","delay","resolveLog","expr","assignment","assign$1","doneInvoke","DoneInvoke","resolveActions","currentState","currentContext","actions","assignActions","otherActions","updatedContext","reduce","acc","assignAction","e_7","meta","partialUpdate","propAssignment","e_7_1","updateContext","sendAction","delaysMap","resolvedDelay","resolvedEvent","configDelay","resolvedTarget","resolveSend","delays","log$1","choose$1","matchedActions","conds","find","resolved","pure$1","get","isLeafNode","stateNode","getChildren","getAllStateNodes","stateNodes","getConfiguration","prevStateNodes","e_3","e_4","_d","prevAdjList","getAdjList","configuration","configuration_1","configuration_1_1","parent","adjList","configuration_2","configuration_2_1","_e","_f","child","sn","initialStateNodes","e_3_1","configuration_3","configuration_3_1","e_4_1","configuration_4","configuration_4_1","set","getValue","rootNode","getValueFromAdj","baseNode","childStateNodes","childStateNode","csn","iterable","some","member","isInFinalState","State","config","_this","activities","events","_sessionid","historyValue","history","matches","bind","toStrings","transitions","children","ownEvents","inert","valueKeys","toJSON","provide","service","createNullActor","createInvocableActor","invokeDefinition","invokeSrc","serviceCreator","services","resolvedData","tempActor","entity","deferred","withContext","initialState","createDeferredActor","isActor","simpleSrc","toInvokeDefinition","invokeConfig","onDone","onError","invokeDef","NULL_EVENT","EMPTY_OBJECT","isStateId","str","createDefaultOptions","StateNode","order","__xstatenode","__cache","relativeValue","initialStateValue","on","candidates","delayedTransitions","idMap","_parent","_key","join","version","parallel","initial","stateConfig","dfs","_transient","always","strict","onEntry","entry","onExit","exit","doneData","invokeSource","activity","transition","_init","withConfig","definition","eventType","getDelayedTransitions","formatTransitions","getCandidates","eventName","transient","sameEventType","afterConfig","after","mutateEntryExit","delayRef","idSuffix","cancel$1","sendId","configTransition","resolvedTransition","isNaN","delayedTransition","formatTransition","getStateNodes","getStateNode","subStateKeys","subStateKey","allSubStateNodes","subStateNode","handles","includes","resolveState","transitionLeafNode","transitionCompoundNode","_transition","transitionParallelNode","transitionMap","stateTransitions","enabledTransitions","st","entryNodes","entrySet","exitSet","source","selectedTransition","nextStateNodes","candidate","stateIn","in","resolvedContext","isInState","getStateNodeById","slice","guardPassed","err","allNextStateNodes","getRelativeStateNodes","isInternal","internal","nodesFromChild","escapes","getActions","prevState","prevConfig","resolvedConfig","resolvedConfig_1","resolvedConfig_1_1","prevConfig_1","prevConfig_1_1","doneEvents","grandparent","sort","entryStates","exitStates","activityDef","entryActions","exitActions","resolvedStateValue","getResolvedPath","test","stateTransition","resolveTransition","resolveRaisedTransition","originalEvent","currentActions","unshift","actions_1","actions_1_1","start$1","stop$1","resolvedActions","raisedEvents","nonRaisedActions","resolvedConfiguration","isDone","nextState","didUpdateContext","changed","maybeNextState","raisedEvent","shift","stateValuesEqual","aKeys","bKeys","stateKey","resolvedStateId","getStateNodeByPath","arrayStatePath","currentStateNode","stateIdentifier","getInitialState","historyConfig","relativeStateId","resolveHistory","initialPath","getFromRelativePath","relativePath","childStatePath","relativeStateValue","historyTarget","relativeChildPath","accessorProp","subHistoryValue","props_2","props_2_1","prop","subStatePath","childStateIds","stateIds","e_8","event_1","e_8_1","resolveTarget","_target","isInternalTarget","transitionConfig","normalizedTarget","normalizeTarget","e_9","onConfig","wildcardConfigs","strictTransitionConfigs_1","hasNonLastUnguardedTarget","transitionConfigArray","eventlessConfig","doneConfig","String","settleTransitions","formattedTransitions","delayedTransitions_1","delayedTransitions_1_1","e_9_1","defaultOptions","deferEvents","Scheduler","processingEvent","queue","initialized","initialize","schedule","flushEvents","task","nextCallback","sessionIdIndex","registry","bookId","register","actor","free","registerService","window","devTools","w","__xstate__","getDevTools","InterpreterStatus","DEFAULT_SPAWN_OPTIONS","sync","autoForward","Interpreter","scheduler","delayedEventsMap","listeners","contextListeners","stopListeners","doneListeners","eventListeners","sendListeners","_status","NotStarted","forwardTo","batch","Stopped","JSON","stringify","Running","forward","_state","sendTo","isParent","Parent","error$1","origin","sessionId","resolvedOptions","clock","logger","resolvedId","_initialState","execute","actionsConfig","listener","_g","_h","_j","_k","contextListener","finalChildStateNode","_l","_m","onTransition","nextListenerOrObserver","_","completeListener","resolvedCompleteListener","complete","onEvent","onSend","onChange","onStop","off","resolvedState","attachDev","e_10","_o","_p","_q","clearTimeout","e_10_1","e_11","batchChanged","batchedActions","_loop_1","events_1","events_1_1","e_11_1","sender","nextEvents","nextEvent","e_12","e_12_1","defer","setTimeout","actionOrExec","spawnPromise","spawnCallback","spawnObservable","spawnMachine","spawnActivity","stopChild","label","childId","spawn","spawnActor","childService","doneEvent","promise","canceled","response","errorData","errorEvent","originalError","currentError","originalStackTrace","stack","stackTrace","reportUnhandledExceptionOnInvocation","handleError","unsubscribed","callbackStop","receivers","newListener","receiver","subscription","implementation","dispose","spawnEffect","__REDUX_DEVTOOLS_EXTENSION__","devToolsOptions","connect","autoPause","stateSanitizer","features","jump","skip","global","ms","self","interpret","subscriber_queue","writable","subscribers","new_value","run_queue","invalidate","subscriber","useMachine","attribute","removeAttribute","getAttribute","setAttribute","handler","insertBefore","addEventListener","removeEventListener","toggleMachine","count","inactive","TOGGLE","active","resolvedInitialContext","$state","body"],"mappings":"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"}